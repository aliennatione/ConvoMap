<!doctype html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
html {
  font-family: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
.markmap-dark {
  background: #27272a;
  color: white;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.12/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/index.js"></script><script>((r) => {
          setTimeout(r);
        })(() => {
  const { markmap, mm } = window;
  const toolbar = new markmap.Toolbar();
  toolbar.attach(mm);
  const el = toolbar.render();
  el.setAttribute("style", "position:absolute;bottom:20px;right:20px");
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
              if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                document.documentElement.classList.add("markmap-dark");
              }
            })(() => window.markmap,null,{"content":"","children":[{"content":"&#x1f4c1; Struttura del progetto (riassunto)","children":[{"content":"<pre data-lines=\"1,14\"><code data-lines=\"1,14\">security-scan-workflow/\n&#x251c;&#x2500;&#x2500; .github/\n&#x2502;   &#x2514;&#x2500;&#x2500; workflows/\n&#x2502;       &#x2514;&#x2500;&#x2500; security-scan<span class=\"hljs-selector-class\">.yml</span>\n&#x251c;&#x2500;&#x2500; tools/\n&#x2502;   &#x251c;&#x2500;&#x2500; quick-scan<span class=\"hljs-selector-class\">.js</span>\n&#x2502;   &#x2514;&#x2500;&#x2500; semgrep-rules<span class=\"hljs-selector-class\">.yml</span>\n&#x251c;&#x2500;&#x2500; <span class=\"hljs-selector-class\">.gitignore</span>\n&#x251c;&#x2500;&#x2500; LICENSE\n&#x251c;&#x2500;&#x2500; README<span class=\"hljs-selector-class\">.md</span>\n&#x2514;&#x2500;&#x2500; package<span class=\"hljs-selector-class\">.json</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1,14"}}],"payload":{"tag":"h1","lines":"0,1"}},{"content":"&#x1f4cb; Contenuto completo dei file","children":[{"content":"README.md","children":[{"content":"<pre data-lines=\"16,74\"><code class=\"language-markdown\"><span class=\"hljs-section\"># Security Scan Workflow per Repository GitHub</span>\n\n<span class=\"hljs-section\">## Obiettivi del progetto</span>\n\nQuesto progetto fornisce un workflow GitHub Actions completo per eseguire analisi di sicurezza automatizzate su repository contenenti codice JavaScript/TypeScript (ma facilmente adattabile ad altri linguaggi). Include anche strumenti personalizzati per migliorare il controllo di sicurezza.\n\n<span class=\"hljs-section\">## Contesto e finalit&#xe0;</span>\n\nL&apos;idea nasce dalla necessit&#xe0; di integrare una pipeline di sicurezza facile da attivare in repository pubblici o privati, che consenta di:\n\n<span class=\"hljs-bullet\">-</span> Individuare vulnerabilit&#xe0; note tramite <span class=\"hljs-code\">`npm audit`</span>\n<span class=\"hljs-bullet\">-</span> Trovare pattern sospetti (es. logging di dati sensibili, chiamate a <span class=\"hljs-code\">`eval`</span>, hardcoded URL HTTP) con <span class=\"hljs-code\">`ripgrep`</span> e script personalizzati\n<span class=\"hljs-bullet\">-</span> Analizzare il codice con Semgrep usando regole custom\n<span class=\"hljs-bullet\">-</span> Eseguire scansione CodeQL ufficiale di GitHub per vulnerabilit&#xe0; pi&#xf9; complesse\n<span class=\"hljs-bullet\">-</span> Fornire report dettagliati facilmente scaricabili come artifact GitHub Actions\n\nQuesta configurazione &#xe8; particolarmente utile per progetti open source, ma anche per repository privati che desiderano migliorare la sicurezza automatica.\n\n<span class=\"hljs-section\">## Struttura del progetto</span>\n\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-code\">`.github/workflows/security-scan.yml`</span>: Workflow GitHub Actions per la scansione di sicurezza\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-code\">`tools/quick-scan.js`</span>: Script Node.js che cerca pattern sospetti nel codice\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-code\">`tools/semgrep-rules.yml`</span>: Regole personalizzate per Semgrep (analisi statica)\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-code\">`.gitignore`</span>: File per ignorare file e cartelle non necessari\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-code\">`package.json`</span>: Configurazione base NPM per installare dipendenze e consentire <span class=\"hljs-code\">`npm audit`</span>\n\n<span class=\"hljs-section\">## Istruzioni per l&#x2019;installazione e l&#x2019;uso</span>\n\n<span class=\"hljs-bullet\">1.</span> <span class=\"hljs-strong\">**Clona questo repository**</span> (o applica la patch al tuo repo esistente).\n<span class=\"hljs-bullet\">2.</span> <span class=\"hljs-strong\">**Abilita GitHub Actions**</span> nel repository.\n<span class=\"hljs-bullet\">3.</span> Il workflow <span class=\"hljs-code\">`security-scan.yml`</span> si attiver&#xe0; automaticamente su:\n<span class=\"hljs-bullet\">   -</span> Push sui branch <span class=\"hljs-code\">`main`</span> o <span class=\"hljs-code\">`master`</span>\n<span class=\"hljs-bullet\">   -</span> Pull request verso <span class=\"hljs-code\">`main`</span> o <span class=\"hljs-code\">`master`</span>\n<span class=\"hljs-bullet\">   -</span> Invocazione manuale tramite la tab Actions &gt; Run workflow\n<span class=\"hljs-bullet\">4.</span> Al termine della scan, i report saranno disponibili come artifact scaricabili.\n<span class=\"hljs-bullet\">5.</span> Per personalizzazioni:\n<span class=\"hljs-bullet\">   -</span> Modifica o aggiungi pattern in <span class=\"hljs-code\">`tools/quick-scan.js`</span>\n<span class=\"hljs-bullet\">   -</span> Aggiorna le regole in <span class=\"hljs-code\">`tools/semgrep-rules.yml`</span>\n<span class=\"hljs-bullet\">   -</span> Puoi adattare <span class=\"hljs-code\">`security-scan.yml`</span> per altri linguaggi o ambienti\n\n<span class=\"hljs-section\">## Tecnologie utilizzate</span>\n\n<span class=\"hljs-bullet\">-</span> [<span class=\"hljs-string\">GitHub Actions</span>](<span class=\"hljs-link\">https://docs.github.com/en/actions</span>)\n<span class=\"hljs-bullet\">-</span> [<span class=\"hljs-string\">CodeQL</span>](<span class=\"hljs-link\">https://securitylab.github.com/tools/codeql</span>)\n<span class=\"hljs-bullet\">-</span> [<span class=\"hljs-string\">Semgrep</span>](<span class=\"hljs-link\">https://semgrep.dev/</span>)\n<span class=\"hljs-bullet\">-</span> [<span class=\"hljs-string\">Node.js</span>](<span class=\"hljs-link\">https://nodejs.org/</span>)\n<span class=\"hljs-bullet\">-</span> [<span class=\"hljs-string\">ripgrep</span>](<span class=\"hljs-link\">https://github.com/BurntSushi/ripgrep</span>)\n<span class=\"hljs-bullet\">-</span> [<span class=\"hljs-string\">npm audit</span>](<span class=\"hljs-link\">https://docs.npmjs.com/cli/v9/commands/npm-audit</span>)\n\n<span class=\"hljs-section\">## Licenza</span>\n\nQuesto progetto &#xe8; rilasciato sotto licenza MIT. Vedi il file <span class=\"hljs-code\">`LICENSE`</span> per dettagli.\n\n---\n\n<span class=\"hljs-quote\">&gt; Creato con passione per aiutarti a mantenere sicuri i tuoi progetti.</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"16,74"}}],"payload":{"tag":"h2","lines":"15,16"}},{"content":".github/workflows/security-scan.yml","children":[{"content":"<pre data-lines=\"75,170\"><code class=\"language-yaml\"><span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Security</span> <span class=\"hljs-string\">scan</span>\n\n<span class=\"hljs-attr\">on:</span>\n  <span class=\"hljs-attr\">workflow_dispatch:</span> {}\n  <span class=\"hljs-attr\">push:</span>\n    <span class=\"hljs-attr\">branches:</span> [ <span class=\"hljs-string\">&quot;main&quot;</span>, <span class=\"hljs-string\">&quot;master&quot;</span> ]\n  <span class=\"hljs-attr\">pull_request:</span>\n    <span class=\"hljs-attr\">branches:</span> [ <span class=\"hljs-string\">&quot;main&quot;</span>, <span class=\"hljs-string\">&quot;master&quot;</span> ]\n\n<span class=\"hljs-attr\">jobs:</span>\n  <span class=\"hljs-attr\">security-scan:</span>\n    <span class=\"hljs-attr\">runs-on:</span> <span class=\"hljs-string\">ubuntu-latest</span>\n    <span class=\"hljs-attr\">permissions:</span>\n      <span class=\"hljs-attr\">contents:</span> <span class=\"hljs-string\">read</span>\n      <span class=\"hljs-attr\">security-events:</span> <span class=\"hljs-string\">write</span>\n\n    <span class=\"hljs-attr\">steps:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Checkout</span> <span class=\"hljs-string\">repo</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/checkout@v4</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">fetch-depth:</span> <span class=\"hljs-number\">0</span>\n\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Setup</span> <span class=\"hljs-string\">Node.js</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/setup-node@v4</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">node-version:</span> <span class=\"hljs-string\">&quot;18&quot;</span>\n\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Ensure</span> <span class=\"hljs-string\">tools</span> <span class=\"hljs-string\">&amp;</span> <span class=\"hljs-string\">ripgrep</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|\n        sudo apt-get update -y\n        sudo apt-get install -y ripgrep unzip jq\n</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Install</span> <span class=\"hljs-string\">dependencies</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|\n        if [ -f package-lock.json ]; then npm ci; else npm install; fi\n</span>      <span class=\"hljs-attr\">env:</span>\n        <span class=\"hljs-attr\">NODE_AUTH_TOKEN:</span> <span class=\"hljs-string\">&#x24;{{</span> <span class=\"hljs-string\">secrets.NPM_TOKEN</span> <span class=\"hljs-string\">||</span> <span class=\"hljs-string\">&apos;&apos;</span> <span class=\"hljs-string\">}}</span>\n\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">npm</span> <span class=\"hljs-string\">audit</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|\n        mkdir -p security-reports\n        npm audit --json &gt; security-reports/npm-audit.json || true\n        jq &apos;{vulnerabilities:.vulnerabilities,metadata:.metadata}&apos; security-reports/npm-audit.json &gt; security-reports/npm-audit-summary.json || true\n</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">ripgrep</span> <span class=\"hljs-string\">quick</span> <span class=\"hljs-string\">patterns</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|\n        mkdir -p security-reports\n        rg --hidden --no-ignore-vcs --line-number --no-heading \\\n          &quot;console\\.log|console\\.error|console\\.warn|phoneNumber|phone|StringSession|session.save|session\\(|apiHash|apiId|process\\.env|eval\\(|new Function|child_process|exec\\(|spawn\\(|fetch\\(|axios|http://|https://&quot; \\\n          &gt; security-reports/rg-findings.txt || true\n        echo &quot;=== HEAD OF FINDINGS ===&quot; &gt;&gt; security-reports/rg-findings.txt\n        head -n 200 security-reports/rg-findings.txt || true\n</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">custom</span> <span class=\"hljs-string\">quick</span> <span class=\"hljs-string\">scan</span> <span class=\"hljs-string\">(node)</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|\n        node tools/quick-scan.js &gt; security-reports/quick-scan.json || true\n        jq . security-reports/quick-scan.json || true\n</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">Semgrep</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">returntocorp/semgrep-action@v2</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">config:</span> <span class=\"hljs-string\">./tools/semgrep-rules.yml</span>\n        <span class=\"hljs-attr\">output:</span> <span class=\"hljs-string\">security-reports/semgrep-report.json</span>\n        <span class=\"hljs-attr\">format:</span> <span class=\"hljs-string\">json</span>\n      <span class=\"hljs-attr\">continue-on-error:</span> <span class=\"hljs-literal\">true</span>\n\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Initialize</span> <span class=\"hljs-string\">CodeQL</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">github/codeql-action/init@v3</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">languages:</span> <span class=\"hljs-string\">javascript</span>\n\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Build</span> <span class=\"hljs-string\">(if</span> <span class=\"hljs-string\">needed)</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|\n        echo &quot;No build step specified.&quot;\n</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">CodeQL</span> <span class=\"hljs-string\">analysis</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">github/codeql-action/analyze@v3</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">output:</span> <span class=\"hljs-string\">security-reports/codeql-results.sarif</span>\n\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Create</span> <span class=\"hljs-string\">reports</span> <span class=\"hljs-string\">zip</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|\n        mkdir -p security-reports\n        ls -la security-reports || true\n        zip -r security-scan-reports.zip security-reports || true\n</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Upload</span> <span class=\"hljs-string\">scan</span> <span class=\"hljs-string\">reports</span> <span class=\"hljs-string\">artifact</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/upload-artifact@v4</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">security-scan-reports</span>\n        <span class=\"hljs-attr\">path:</span> <span class=\"hljs-string\">|\n          security-scan-reports.zip\n          security-reports/**/*\n</span></code></pre>","children":[],"payload":{"tag":"pre","lines":"75,170"}}],"payload":{"tag":"h2","lines":"74,75"}},{"content":"tools/quick-scan.js","children":[{"content":"<pre data-lines=\"171,251\"><code class=\"language-js\"><span class=\"hljs-comment\">/**\n * tools/quick-scan.js\n *\n * Script Node.js che analizza i file testuali nel repository per individuare pattern sospetti\n * come logging di numeri di telefono, chiamate a eval, uso di child_process ecc.\n *\n * Uscita: JSON dettagliato con i file, pattern trovati e linee contenenti le occorrenze.\n */</span>\n\n<span class=\"hljs-keyword\">const</span> fs = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;fs&apos;</span>);\n<span class=\"hljs-keyword\">const</span> path = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;path&apos;</span>);\n\n<span class=\"hljs-keyword\">const</span> repoRoot = process.<span class=\"hljs-title function_\">cwd</span>();\n<span class=\"hljs-keyword\">const</span> ignoreDirs = [<span class=\"hljs-string\">&apos;node_modules&apos;</span>, <span class=\"hljs-string\">&apos;.git&apos;</span>, <span class=\"hljs-string\">&apos;.github&apos;</span>, <span class=\"hljs-string\">&apos;dist&apos;</span>, <span class=\"hljs-string\">&apos;build&apos;</span>, <span class=\"hljs-string\">&apos;coverage&apos;</span>];\n\n<span class=\"hljs-keyword\">const</span> patterns = [\n  { <span class=\"hljs-attr\">id</span>: <span class=\"hljs-string\">&apos;phone&apos;</span>, <span class=\"hljs-attr\">re</span>: <span class=\"hljs-regexp\">/\\b(phone|phoneNumber|sms)\\b/i</span> },\n  { <span class=\"hljs-attr\">id</span>: <span class=\"hljs-string\">&apos;session&apos;</span>, <span class=\"hljs-attr\">re</span>: <span class=\"hljs-regexp\">/\\b(StringSession|session\\.save|session\\s*=\\s*)\\b/i</span> },\n  { <span class=\"hljs-attr\">id</span>: <span class=\"hljs-string\">&apos;console&apos;</span>, <span class=\"hljs-attr\">re</span>: <span class=\"hljs-regexp\">/\\bconsole\\.(log|error|warn|info)\\b/i</span> },\n  { <span class=\"hljs-attr\">id</span>: <span class=\"hljs-string\">&apos;eval&apos;</span>, <span class=\"hljs-attr\">re</span>: <span class=\"hljs-regexp\">/\\beval\\(|\\bnew Function\\b/i</span> },\n  { <span class=\"hljs-attr\">id</span>: <span class=\"hljs-string\">&apos;child_process&apos;</span>, <span class=\"hljs-attr\">re</span>: <span class=\"hljs-regexp\">/\\b(child_process|exec\\(|spawn\\()/i</span> },\n  { <span class=\"hljs-attr\">id</span>: <span class=\"hljs-string\">&apos;http&apos;</span>, <span class=\"hljs-attr\">re</span>: <span class=\"hljs-regexp\">/\\bhttps?:\\/\\/[^\\s&apos;&quot;]+/i</span> },\n  { <span class=\"hljs-attr\">id</span>: <span class=\"hljs-string\">&apos;apiKeys&apos;</span>, <span class=\"hljs-attr\">re</span>: <span class=\"hljs-regexp\">/\\b(api(Id|Hash)|api_key|apiKey|API_KEY)\\b/i</span> },\n  { <span class=\"hljs-attr\">id</span>: <span class=\"hljs-string\">&apos;processenv&apos;</span>, <span class=\"hljs-attr\">re</span>: <span class=\"hljs-regexp\">/\\bprocess\\.env\\b/i</span> }\n];\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">walk</span>(<span class=\"hljs-params\">dir</span>) {\n  <span class=\"hljs-keyword\">const</span> results = [];\n  <span class=\"hljs-keyword\">const</span> list = fs.<span class=\"hljs-title function_\">readdirSync</span>(dir);\n  <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> file <span class=\"hljs-keyword\">of</span> list) {\n    <span class=\"hljs-keyword\">const</span> full = path.<span class=\"hljs-title function_\">join</span>(dir, file);\n    <span class=\"hljs-keyword\">const</span> stat = fs.<span class=\"hljs-title function_\">statSync</span>(full);\n    <span class=\"hljs-keyword\">if</span> (stat &amp;&amp; stat.<span class=\"hljs-title function_\">isDirectory</span>()) {\n      <span class=\"hljs-keyword\">if</span> (ignoreDirs.<span class=\"hljs-title function_\">includes</span>(file)) <span class=\"hljs-keyword\">continue</span>;\n      results.<span class=\"hljs-title function_\">push</span>(...<span class=\"hljs-title function_\">walk</span>(full));\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-comment\">// solo file testuali (estensioni comuni o senza estensione)</span>\n      <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-regexp\">/\\.(js|ts|json|env|sh|py|yml|yaml|md|html)&#x24;/</span>.<span class=\"hljs-title function_\">test</span>(full) || !path.<span class=\"hljs-title function_\">extname</span>(full)) {\n        <span class=\"hljs-keyword\">try</span> {\n          <span class=\"hljs-keyword\">const</span> txt = fs.<span class=\"hljs-title function_\">readFileSync</span>(full, <span class=\"hljs-string\">&apos;utf8&apos;</span>);\n          results.<span class=\"hljs-title function_\">push</span>({ <span class=\"hljs-attr\">file</span>: path.<span class=\"hljs-title function_\">relative</span>(repoRoot, full), <span class=\"hljs-attr\">text</span>: txt });\n        } <span class=\"hljs-keyword\">catch</span> (e) {\n          <span class=\"hljs-comment\">// ignora file binari o non leggibili</span>\n        }\n      }\n    }\n  }\n  <span class=\"hljs-keyword\">return</span> results;\n}\n\n<span class=\"hljs-keyword\">const</span> files = <span class=\"hljs-title function_\">walk</span>(repoRoot);\n<span class=\"hljs-keyword\">const</span> findings = [];\n\n<span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> f <span class=\"hljs-keyword\">of</span> files) {\n  <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> p <span class=\"hljs-keyword\">of</span> patterns) {\n    <span class=\"hljs-keyword\">const</span> lines = [];\n    <span class=\"hljs-keyword\">const</span> re = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">RegExp</span>(p.<span class=\"hljs-property\">re</span>, <span class=\"hljs-string\">&apos;gmi&apos;</span>);\n    <span class=\"hljs-keyword\">const</span> linesArr = f.<span class=\"hljs-property\">text</span>.<span class=\"hljs-title function_\">split</span>(<span class=\"hljs-regexp\">/\\r?\\n/</span>);\n    <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">let</span> i = <span class=\"hljs-number\">0</span>; i &lt; linesArr.<span class=\"hljs-property\">length</span>; i++) {\n      <span class=\"hljs-keyword\">if</span> (re.<span class=\"hljs-title function_\">test</span>(linesArr[i])) {\n        lines.<span class=\"hljs-title function_\">push</span>({ <span class=\"hljs-attr\">line</span>: i + <span class=\"hljs-number\">1</span>, <span class=\"hljs-attr\">content</span>: linesArr[i].<span class=\"hljs-title function_\">trim</span>() });\n      }\n      re.<span class=\"hljs-property\">lastIndex</span> = <span class=\"hljs-number\">0</span>; <span class=\"hljs-comment\">// reset regex globale</span>\n    }\n    <span class=\"hljs-keyword\">if</span> (lines.<span class=\"hljs-property\">length</span>) {\n      findings.<span class=\"hljs-title function_\">push</span>({ <span class=\"hljs-attr\">file</span>: f.<span class=\"hljs-property\">file</span>, <span class=\"hljs-attr\">pattern</span>: p.<span class=\"hljs-property\">id</span>, <span class=\"hljs-attr\">matches</span>: lines });\n    }\n  }\n}\n\n<span class=\"hljs-keyword\">const</span> out = {\n  <span class=\"hljs-attr\">scanned_files</span>: files.<span class=\"hljs-property\">length</span>,\n  <span class=\"hljs-attr\">findings_count</span>: findings.<span class=\"hljs-property\">length</span>,\n  findings\n};\n\n<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(out, <span class=\"hljs-literal\">null</span>, <span class=\"hljs-number\">2</span>));\nprocess.<span class=\"hljs-title function_\">exit</span>(<span class=\"hljs-number\">0</span>);\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"171,251"}}],"payload":{"tag":"h2","lines":"170,171"}},{"content":"tools/semgrep-rules.yml","children":[{"content":"<pre data-lines=\"252,281\"><code class=\"language-yaml\"><span class=\"hljs-attr\">rules:</span>\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">js-no-eval</span>\n    <span class=\"hljs-attr\">patterns:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">eval(...)</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">new</span> <span class=\"hljs-string\">Function(...)</span>\n    <span class=\"hljs-attr\">message:</span> <span class=\"hljs-string\">&quot;Avoid use of eval/new Function.&quot;</span>\n    <span class=\"hljs-attr\">severity:</span> <span class=\"hljs-string\">ERROR</span>\n    <span class=\"hljs-attr\">languages:</span> [<span class=\"hljs-string\">javascript</span>,<span class=\"hljs-string\">typescript</span>]\n\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">js-console-phone</span>\n    <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">console.log(...)</span>\n    <span class=\"hljs-attr\">message:</span> <span class=\"hljs-string\">&quot;Avoid logging potentially sensitive variables (phone, session).&quot;</span>\n    <span class=\"hljs-attr\">severity:</span> <span class=\"hljs-string\">WARNING</span>\n    <span class=\"hljs-attr\">languages:</span> [<span class=\"hljs-string\">javascript</span>,<span class=\"hljs-string\">typescript</span>]\n\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">js-child-process</span>\n    <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">|\n      require(&apos;child_process&apos;).&#x24;X(...)\n</span>    <span class=\"hljs-attr\">message:</span> <span class=\"hljs-string\">&quot;Potential command execution via child_process.&quot;</span>\n    <span class=\"hljs-attr\">severity:</span> <span class=\"hljs-string\">ERROR</span>\n    <span class=\"hljs-attr\">languages:</span> [<span class=\"hljs-string\">javascript</span>,<span class=\"hljs-string\">typescript</span>]\n\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">http-hardcoded</span>\n    <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">&quot;http://&#x24;URL&quot;</span>\n    <span class=\"hljs-attr\">message:</span> <span class=\"hljs-string\">&quot;Hardcoded HTTP URL found; prefer HTTPS and validate target hosts.&quot;</span>\n    <span class=\"hljs-attr\">severity:</span> <span class=\"hljs-string\">WARNING</span>\n    <span class=\"hljs-attr\">languages:</span> [<span class=\"hljs-string\">javascript</span>,<span class=\"hljs-string\">typescript</span>]\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"252,281"}}],"payload":{"tag":"h2","lines":"251,252"}},{"content":".gitignore","children":[{"content":"<pre data-lines=\"282,312\"><code data-lines=\"282,312\"><span class=\"hljs-comment\"># Node modules</span>\nnode_modules/\n\n<span class=\"hljs-comment\"># Logs</span>\nnpm-debug.log*\nyarn-debug.log*\nyarn-error.log*\n\n<span class=\"hljs-comment\"># Dependency directories</span>\ndist/\nbuild/\ncoverage/\n\n<span class=\"hljs-comment\"># System files</span>\n<span class=\"hljs-string\">.DS_Store</span>\nThumbs.db\n\n<span class=\"hljs-comment\"># GitHub Actions cache</span>\n<span class=\"hljs-string\">.github/actions/cache/</span>\n\n<span class=\"hljs-comment\"># Environment files</span>\n<span class=\"hljs-string\">.env</span>\n<span class=\"hljs-string\">.env.local</span>\n<span class=\"hljs-string\">.env.</span>*<span class=\"hljs-string\">.local</span>\n\n<span class=\"hljs-comment\"># Editor config</span>\n<span class=\"hljs-string\">.vscode/</span>\n<span class=\"hljs-string\">.idea/</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"282,312"}}],"payload":{"tag":"h2","lines":"281,282"}},{"content":"LICENSE (MIT)","children":[{"content":"<pre data-lines=\"313,336\"><code class=\"language-text\">MIT License\n\nCopyright (c) 2025 [Your Name or Your Org]\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the &quot;Software&quot;), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"313,336"}}],"payload":{"tag":"h2","lines":"312,313"}},{"content":"package.json (minimale)","children":[{"content":"<pre data-lines=\"337,351\"><code class=\"language-json\"><span class=\"hljs-punctuation\">{</span>\n  <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;security-scan-workflow&quot;</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;version&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;1.0.0&quot;</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;description&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;GitHub Actions workflow and tools for automated security scanning&quot;</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;main&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;tools/quick-scan.js&quot;</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;scripts&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n    <span class=\"hljs-attr\">&quot;quickscan&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;node tools/quick-scan.js&quot;</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;author&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;[Your Name]&quot;</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;license&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;MIT&quot;</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;dependencies&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span>\n<span class=\"hljs-punctuation\">}</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"337,351"}}],"payload":{"tag":"h2","lines":"336,337"}}],"payload":{"tag":"h1","lines":"14,15"}},{"content":"&#x1f3af; Note finali","children":[{"content":"2. Eseguire il workflow completo (su GitHub Actions)","children":[{"content":"<code>npm audit</code>","children":[],"payload":{"tag":"li","lines":"823,824"}},{"content":"ricerca pattern con ripgrep","children":[],"payload":{"tag":"li","lines":"824,825"}},{"content":"script <code>quick-scan.js</code>","children":[],"payload":{"tag":"li","lines":"825,826"}},{"content":"Semgrep","children":[],"payload":{"tag":"li","lines":"826,827"}},{"content":"CodeQL","children":[],"payload":{"tag":"li","lines":"827,829"}}],"payload":{"tag":"h2","lines":"819,820"}},{"content":"3. Estrarre e visualizzare il report completo","children":[{"content":"<pre data-lines=\"833,836\"><code class=\"language-bash\">npm run extract-report\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"833,836"}},{"content":"<pre data-lines=\"839,841\"><code data-lines=\"839,841\"></code></pre>","children":[],"payload":{"tag":"pre","lines":"839,841"}}],"payload":{"tag":"h2","lines":"829,830"}},{"content":"///<br>\n\\\\","children":[],"payload":{"tag":"h2","lines":"843,846"}}],"payload":{"tag":"h1","lines":"351,352"}},{"content":"&#x1f4e6; <strong>security-scan-integration</strong>","children":[{"content":"1. README.md","children":[{"content":"Esempio di esecuzione manuale","children":[{"content":"<code>npm run quickscan</code> esegue la scansione custom di pattern sospetti.","children":[],"payload":{"tag":"li","lines":"884,885"}},{"content":"<code>npm run extract-report</code> crea un sommario dei risultati.","children":[],"payload":{"tag":"li","lines":"885,886"}}],"payload":{"tag":"h3","lines":"883,884"}},{"content":"Workflow GitHub Actions","children":[{"content":"<code>npm audit</code> con report json","children":[],"payload":{"tag":"li","lines":"888,889"}},{"content":"scansione pattern con <code>ripgrep</code>","children":[],"payload":{"tag":"li","lines":"889,890"}},{"content":"esecuzione script <code>tools/quick-scan.js</code>","children":[],"payload":{"tag":"li","lines":"890,891"}},{"content":"scansione <code>semgrep</code>","children":[],"payload":{"tag":"li","lines":"891,892"}},{"content":"scansione CodeQL con report in SARIF<br>\nTutti i report sono salvati in <code>security-reports/</code>.","children":[],"payload":{"tag":"li","lines":"892,894"}}],"payload":{"tag":"h3","lines":"886,887"}}],"payload":{"tag":"h2","lines":"856,857"}},{"content":"Tecnologie utilizzate","children":[{"content":"Node.js","children":[],"payload":{"tag":"li","lines":"895,896"}},{"content":"GitHub Actions","children":[],"payload":{"tag":"li","lines":"896,897"}},{"content":"ripgrep","children":[],"payload":{"tag":"li","lines":"897,898"}},{"content":"Semgrep","children":[],"payload":{"tag":"li","lines":"898,899"}},{"content":"CodeQL","children":[],"payload":{"tag":"li","lines":"899,900"}},{"content":"npm audit","children":[],"payload":{"tag":"li","lines":"900,901"}}],"payload":{"tag":"h2","lines":"894,895"}},{"content":"Struttura del progetto","children":[{"content":"<pre data-lines=\"902,917\"><code data-lines=\"902,917\">security-scan-integration/\n&#x251c;&#x2500;&#x2500; .github/\n&#x2502;   &#x2514;&#x2500;&#x2500; workflows/\n&#x2502;       &#x2514;&#x2500;&#x2500; security-scan<span class=\"hljs-selector-class\">.yml</span>\n&#x251c;&#x2500;&#x2500; tools/\n&#x2502;   &#x251c;&#x2500;&#x2500; quick-scan<span class=\"hljs-selector-class\">.js</span>\n&#x2502;   &#x2514;&#x2500;&#x2500; extract-reports<span class=\"hljs-selector-class\">.js</span>\n&#x251c;&#x2500;&#x2500; examples/\n&#x2502;   &#x2514;&#x2500;&#x2500; README<span class=\"hljs-selector-class\">.md</span>\n&#x251c;&#x2500;&#x2500; <span class=\"hljs-selector-class\">.gitignore</span>\n&#x251c;&#x2500;&#x2500; LICENSE\n&#x251c;&#x2500;&#x2500; package<span class=\"hljs-selector-class\">.json</span>\n&#x2514;&#x2500;&#x2500; README<span class=\"hljs-selector-class\">.md</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"902,917"}}],"payload":{"tag":"h2","lines":"901,902"}},{"content":"Licenza","children":[{"content":"<pre data-lines=\"919,940\"><code data-lines=\"919,940\">\n<span class=\"hljs-meta\">---\n</span>\n<span class=\"hljs-comment\">## 2. Struttura cartelle e file</span>\n\n<span class=\"hljs-string\">```plaintext</span>\n<span class=\"hljs-string\">security-scan-integration/</span>\n<span class=\"hljs-string\">&#x251c;&#x2500;&#x2500;</span> <span class=\"hljs-string\">.github/</span>\n<span class=\"hljs-string\">&#x2502;</span>   <span class=\"hljs-string\">&#x2514;&#x2500;&#x2500;</span> <span class=\"hljs-string\">workflows/</span>\n<span class=\"hljs-string\">&#x2502;</span>       <span class=\"hljs-string\">&#x2514;&#x2500;&#x2500;</span> <span class=\"hljs-string\">security-scan.yml</span>\n<span class=\"hljs-string\">&#x251c;&#x2500;&#x2500;</span> <span class=\"hljs-string\">tools/</span>\n<span class=\"hljs-string\">&#x2502;</span>   <span class=\"hljs-string\">&#x251c;&#x2500;&#x2500;</span> <span class=\"hljs-string\">quick-scan.js</span>\n<span class=\"hljs-string\">&#x2502;</span>   <span class=\"hljs-string\">&#x2514;&#x2500;&#x2500;</span> <span class=\"hljs-string\">extract-reports.js</span>\n<span class=\"hljs-string\">&#x251c;&#x2500;&#x2500;</span> <span class=\"hljs-string\">examples/</span>\n<span class=\"hljs-string\">&#x2502;</span>   <span class=\"hljs-string\">&#x2514;&#x2500;&#x2500;</span> <span class=\"hljs-string\">README.md</span>\n<span class=\"hljs-string\">&#x251c;&#x2500;&#x2500;</span> <span class=\"hljs-string\">.gitignore</span>\n<span class=\"hljs-string\">&#x251c;&#x2500;&#x2500;</span> <span class=\"hljs-string\">LICENSE</span>\n<span class=\"hljs-string\">&#x251c;&#x2500;&#x2500;</span> <span class=\"hljs-string\">package.json</span>\n<span class=\"hljs-string\">&#x2514;&#x2500;&#x2500;</span> <span class=\"hljs-string\">README.md</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"919,940"}}],"payload":{"tag":"h2","lines":"917,918"}},{"content":"3. Codice sorgente completo","children":[{"content":"<code>.github/workflows/security-scan.yml</code>","children":[{"content":"<pre data-lines=\"947,1005\"><code class=\"language-yaml\"><span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Security</span> <span class=\"hljs-string\">Scan</span> <span class=\"hljs-string\">Workflow</span>\n<span class=\"hljs-attr\">on:</span>\n  <span class=\"hljs-attr\">push:</span>\n    <span class=\"hljs-attr\">branches:</span> [ <span class=\"hljs-string\">main</span> ]\n  <span class=\"hljs-attr\">pull_request:</span>\n    <span class=\"hljs-attr\">branches:</span> [ <span class=\"hljs-string\">main</span> ]\n  <span class=\"hljs-attr\">schedule:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">cron:</span> <span class=\"hljs-string\">&apos;26 7 * * 1&apos;</span>\n<span class=\"hljs-attr\">jobs:</span>\n  <span class=\"hljs-attr\">security-scan:</span>\n    <span class=\"hljs-attr\">runs-on:</span> <span class=\"hljs-string\">ubuntu-latest</span>\n    <span class=\"hljs-attr\">permissions:</span>\n      <span class=\"hljs-attr\">security-events:</span> <span class=\"hljs-string\">write</span>\n      <span class=\"hljs-attr\">contents:</span> <span class=\"hljs-string\">read</span>\n      <span class=\"hljs-attr\">actions:</span> <span class=\"hljs-string\">read</span>\n      <span class=\"hljs-attr\">packages:</span> <span class=\"hljs-string\">read</span>\n    <span class=\"hljs-attr\">steps:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Checkout</span> <span class=\"hljs-string\">code</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/checkout@v4</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Setup</span> <span class=\"hljs-string\">Node.js</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/setup-node@v3</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">node-version:</span> <span class=\"hljs-string\">&apos;18&apos;</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Install</span> <span class=\"hljs-string\">dependencies</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">npm</span> <span class=\"hljs-string\">install</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">npm</span> <span class=\"hljs-string\">audit</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">npm</span> <span class=\"hljs-string\">audit</span> <span class=\"hljs-string\">--json</span> <span class=\"hljs-string\">&gt;</span> <span class=\"hljs-string\">security-reports/npm-audit.json</span> <span class=\"hljs-string\">||</span> <span class=\"hljs-literal\">true</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Generate</span> <span class=\"hljs-string\">npm</span> <span class=\"hljs-string\">audit</span> <span class=\"hljs-string\">summary</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|\n        node -e &quot;const audit=require(&apos;./security-reports/npm-audit.json&apos;); \\\n        const summary={metadata:audit.metadata,vulnerabilities:audit.vulnerabilities||{}}; \\\n        require(&apos;fs&apos;).writeFileSync(&apos;security-reports/npm-audit-summary.json&apos;,JSON.stringify(summary,null,2))&quot;\n</span>    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">ripgrep</span> <span class=\"hljs-string\">for</span> <span class=\"hljs-string\">sensitive</span> <span class=\"hljs-string\">patterns</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|\n        mkdir -p security-reports\n        rg --json --json-path &apos;.data.lines[0].text&apos; --json-seq --json-seq-delim &apos;\\n&apos; &apos;token|password|secret|apikey|api_key|access_key&apos; &gt; security-reports/ripgrep-report.json || true\n</span>    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">custom</span> <span class=\"hljs-string\">quick</span> <span class=\"hljs-string\">scan</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">node</span> <span class=\"hljs-string\">tools/quick-scan.js</span> <span class=\"hljs-string\">&gt;</span> <span class=\"hljs-string\">security-reports/quick-scan.json</span> <span class=\"hljs-string\">||</span> <span class=\"hljs-literal\">true</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">semgrep</span> <span class=\"hljs-string\">scan</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">returntocorp/semgrep-action@v1</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">config:</span> <span class=\"hljs-string\">&quot;p/ci&quot;</span>\n        <span class=\"hljs-attr\">output:</span> <span class=\"hljs-string\">security-reports/semgrep-report.json</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Initialize</span> <span class=\"hljs-string\">CodeQL</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">github/codeql-action/init@v3</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">languages:</span> <span class=\"hljs-string\">javascript</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Perform</span> <span class=\"hljs-string\">CodeQL</span> <span class=\"hljs-string\">Analysis</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">github/codeql-action/analyze@v3</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">category:</span> <span class=\"hljs-string\">&apos;/language:javascript&apos;</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Upload</span> <span class=\"hljs-string\">Security</span> <span class=\"hljs-string\">Reports</span> <span class=\"hljs-string\">as</span> <span class=\"hljs-string\">artifacts</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/upload-artifact@v3</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">security-reports</span>\n        <span class=\"hljs-attr\">path:</span> <span class=\"hljs-string\">security-reports/</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"947,1005"}}],"payload":{"tag":"h3","lines":"945,946"}},{"content":"<code>tools/quick-scan.js</code>","children":[{"content":"<pre data-lines=\"1010,1064\"><code class=\"language-js\"><span class=\"hljs-comment\">/**\n * tools/quick-scan.js\n *\n * Scans source files in the repository for suspicious patterns.\n * Outputs JSON with file, pattern, and matching lines.\n */</span>\n<span class=\"hljs-keyword\">const</span> fs = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;fs&apos;</span>);\n<span class=\"hljs-keyword\">const</span> path = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;path&apos;</span>);\n<span class=\"hljs-keyword\">const</span> { execSync } = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;child_process&apos;</span>);\n<span class=\"hljs-keyword\">const</span> patterns = [\n  <span class=\"hljs-string\">&apos;token&apos;</span>,\n  <span class=\"hljs-string\">&apos;password&apos;</span>,\n  <span class=\"hljs-string\">&apos;secret&apos;</span>,\n  <span class=\"hljs-string\">&apos;apikey&apos;</span>,\n  <span class=\"hljs-string\">&apos;api_key&apos;</span>,\n  <span class=\"hljs-string\">&apos;access_key&apos;</span>,\n];\n<span class=\"hljs-keyword\">const</span> rgCommand = <span class=\"hljs-string\">`rg --json --json-path &apos;.data.lines[0].text&apos; --json-seq --json-seq-delim &apos;\\\\n&apos; &apos;<span class=\"hljs-subst\">&#x24;{patterns.join(<span class=\"hljs-string\">&apos;|&apos;</span>)}</span>&apos;`</span>;\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">scan</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">try</span> {\n    <span class=\"hljs-keyword\">const</span> out = <span class=\"hljs-title function_\">execSync</span>(rgCommand, { <span class=\"hljs-attr\">encoding</span>: <span class=\"hljs-string\">&apos;utf-8&apos;</span> });\n    <span class=\"hljs-keyword\">const</span> lines = out.<span class=\"hljs-title function_\">trim</span>().<span class=\"hljs-title function_\">split</span>(<span class=\"hljs-string\">&apos;\\n&apos;</span>);\n    <span class=\"hljs-keyword\">const</span> results = {};\n    lines.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">line</span> =&gt;</span> {\n      <span class=\"hljs-keyword\">if</span> (!line) <span class=\"hljs-keyword\">return</span>;\n      <span class=\"hljs-keyword\">try</span> {\n        <span class=\"hljs-keyword\">const</span> json = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(line);\n        <span class=\"hljs-keyword\">if</span> (!json.<span class=\"hljs-property\">data</span> || !json.<span class=\"hljs-property\">data</span>.<span class=\"hljs-property\">lines</span>) <span class=\"hljs-keyword\">return</span>;\n        <span class=\"hljs-keyword\">const</span> file = json.<span class=\"hljs-property\">data</span>.<span class=\"hljs-property\">path</span>.<span class=\"hljs-property\">text</span>;\n        <span class=\"hljs-keyword\">const</span> text = json.<span class=\"hljs-property\">data</span>.<span class=\"hljs-property\">lines</span>[<span class=\"hljs-number\">0</span>].<span class=\"hljs-property\">text</span>;\n        <span class=\"hljs-keyword\">const</span> lineNum = json.<span class=\"hljs-property\">data</span>.<span class=\"hljs-property\">lines</span>[<span class=\"hljs-number\">0</span>].<span class=\"hljs-property\">line</span>;\n        <span class=\"hljs-keyword\">if</span> (!results[file]) {\n          results[file] = [];\n        }\n        results[file].<span class=\"hljs-title function_\">push</span>({ <span class=\"hljs-attr\">line</span>: lineNum, <span class=\"hljs-attr\">content</span>: text });\n      } <span class=\"hljs-keyword\">catch</span> {}\n    });\n    <span class=\"hljs-keyword\">const</span> findings = <span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">entries</span>(results).<span class=\"hljs-title function_\">map</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">[file, matches]</span>) =&gt;</span> ({\n      file,\n      <span class=\"hljs-attr\">pattern</span>: patterns.<span class=\"hljs-title function_\">find</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">p</span> =&gt;</span> matches.<span class=\"hljs-title function_\">some</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">m</span> =&gt;</span> m.<span class=\"hljs-property\">content</span>.<span class=\"hljs-title function_\">toLowerCase</span>().<span class=\"hljs-title function_\">includes</span>(p))),\n      matches,\n    }));\n    <span class=\"hljs-keyword\">return</span> { findings, <span class=\"hljs-attr\">findings_count</span>: findings.<span class=\"hljs-property\">length</span> };\n  } <span class=\"hljs-keyword\">catch</span> (err) {\n    <span class=\"hljs-keyword\">return</span> { <span class=\"hljs-attr\">findings</span>: [], <span class=\"hljs-attr\">findings_count</span>: <span class=\"hljs-number\">0</span> };\n  }\n}\n<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">require</span>.<span class=\"hljs-property\">main</span> === <span class=\"hljs-variable language_\">module</span>) {\n  <span class=\"hljs-keyword\">const</span> report = <span class=\"hljs-title function_\">scan</span>();\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(report, <span class=\"hljs-literal\">null</span>, <span class=\"hljs-number\">2</span>));\n}\n<span class=\"hljs-variable language_\">module</span>.<span class=\"hljs-property\">exports</span> = { scan };\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1010,1064"}}],"payload":{"tag":"h3","lines":"1008,1009"}},{"content":"<code>tools/extract-reports.js</code>","children":[{"content":"<pre data-lines=\"1069,1183\"><code class=\"language-js\"><span class=\"hljs-comment\">/**\n * tools/extract-reports.js\n *\n * Aggregates security scan reports into a readable summary.\n *\n * Usage:\n *    node tools/extract-reports.js\n */</span>\n<span class=\"hljs-keyword\">const</span> fs = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;fs&apos;</span>);\n<span class=\"hljs-keyword\">const</span> path = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;path&apos;</span>);\n<span class=\"hljs-keyword\">const</span> reportsDir = path.<span class=\"hljs-title function_\">resolve</span>(process.<span class=\"hljs-title function_\">cwd</span>(), <span class=\"hljs-string\">&apos;security-reports&apos;</span>);\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">safeReadJson</span>(<span class=\"hljs-params\">filename</span>) {\n  <span class=\"hljs-keyword\">try</span> {\n    <span class=\"hljs-keyword\">const</span> content = fs.<span class=\"hljs-title function_\">readFileSync</span>(path.<span class=\"hljs-title function_\">join</span>(reportsDir, filename), <span class=\"hljs-string\">&apos;utf-8&apos;</span>);\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(content);\n  } <span class=\"hljs-keyword\">catch</span> {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n  }\n}\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">printNpmAuditSummary</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">const</span> audit = <span class=\"hljs-title function_\">safeReadJson</span>(<span class=\"hljs-string\">&apos;npm-audit-summary.json&apos;</span>);\n  <span class=\"hljs-keyword\">if</span> (!audit) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;No npm audit summary found.&apos;</span>);\n    <span class=\"hljs-keyword\">return</span>;\n  }\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;=== npm Audit Summary ===&apos;</span>);\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`Total dependencies: <span class=\"hljs-subst\">&#x24;{audit.metadata.totalDependencies}</span>`</span>);\n  <span class=\"hljs-keyword\">if</span> (audit.<span class=\"hljs-property\">vulnerabilities</span>) {\n    <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> [type, details] <span class=\"hljs-keyword\">of</span> <span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">entries</span>(audit.<span class=\"hljs-property\">vulnerabilities</span>)) {\n      <span class=\"hljs-keyword\">if</span> (details.<span class=\"hljs-property\">count</span> &gt; <span class=\"hljs-number\">0</span>) {\n        <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">` - <span class=\"hljs-subst\">&#x24;{type}</span>: <span class=\"hljs-subst\">&#x24;{details.count}</span>`</span>);\n      }\n    }\n  }\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;&apos;</span>);\n}\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">printQuickScanSummary</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">const</span> quickScan = <span class=\"hljs-title function_\">safeReadJson</span>(<span class=\"hljs-string\">&apos;quick-scan.json&apos;</span>);\n  <span class=\"hljs-keyword\">if</span> (!quickScan) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;No quick scan report found.&apos;</span>);\n    <span class=\"hljs-keyword\">return</span>;\n  }\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;=== Quick Scan Findings ===&apos;</span>);\n  <span class=\"hljs-keyword\">if</span> (quickScan.<span class=\"hljs-property\">findings_count</span> === <span class=\"hljs-number\">0</span>) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;No suspicious patterns found.&apos;</span>);\n  } <span class=\"hljs-keyword\">else</span> {\n    quickScan.<span class=\"hljs-property\">findings</span>.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">f</span> =&gt;</span> {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`File: <span class=\"hljs-subst\">&#x24;{f.file}</span> (pattern: <span class=\"hljs-subst\">&#x24;{f.pattern}</span>)`</span>);\n      f.<span class=\"hljs-property\">matches</span>.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">m</span> =&gt;</span> {\n        <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`  Line <span class=\"hljs-subst\">&#x24;{m.line}</span>: <span class=\"hljs-subst\">&#x24;{m.content}</span>`</span>);\n      });\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;&apos;</span>);\n    });\n  }\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;&apos;</span>);\n}\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">printSemgrepSummary</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">const</span> semgrepRaw = <span class=\"hljs-title function_\">safeReadJson</span>(<span class=\"hljs-string\">&apos;semgrep-report.json&apos;</span>);\n  <span class=\"hljs-keyword\">if</span> (!semgrepRaw || !semgrepRaw.<span class=\"hljs-property\">results</span>) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;No Semgrep report found.&apos;</span>);\n    <span class=\"hljs-keyword\">return</span>;\n  }\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;=== Semgrep Findings ===&apos;</span>);\n  <span class=\"hljs-keyword\">if</span> (semgrepRaw.<span class=\"hljs-property\">results</span>.<span class=\"hljs-property\">length</span> === <span class=\"hljs-number\">0</span>) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;No issues found by Semgrep.&apos;</span>);\n  } <span class=\"hljs-keyword\">else</span> {\n    semgrepRaw.<span class=\"hljs-property\">results</span>.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">res, idx</span>) =&gt;</span> {\n      <span class=\"hljs-keyword\">const</span> loc = res.<span class=\"hljs-property\">location</span> || {};\n      <span class=\"hljs-keyword\">const</span> path = loc.<span class=\"hljs-property\">path</span> || <span class=\"hljs-string\">&apos;unknown file&apos;</span>;\n      <span class=\"hljs-keyword\">const</span> line = loc.<span class=\"hljs-property\">start</span>?.<span class=\"hljs-property\">line</span> || <span class=\"hljs-string\">&apos;unknown line&apos;</span>;\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`<span class=\"hljs-subst\">&#x24;{idx + <span class=\"hljs-number\">1</span>}</span>. <span class=\"hljs-subst\">&#x24;{res.check_id}</span> [<span class=\"hljs-subst\">&#x24;{res.severity}</span>]`</span>);\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`   File: <span class=\"hljs-subst\">&#x24;{path}</span>:<span class=\"hljs-subst\">&#x24;{line}</span>`</span>);\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`   Message: <span class=\"hljs-subst\">&#x24;{res.extra.message}</span>`</span>);\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;&apos;</span>);\n    });\n  }\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;&apos;</span>);\n}\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">printCodeQLSummary</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">const</span> sarifPath = path.<span class=\"hljs-title function_\">join</span>(reportsDir, <span class=\"hljs-string\">&apos;codeql-results.sarif&apos;</span>);\n  <span class=\"hljs-keyword\">if</span> (!fs.<span class=\"hljs-title function_\">existsSync</span>(sarifPath)) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;No CodeQL SARIF report found.&apos;</span>);\n    <span class=\"hljs-keyword\">return</span>;\n  }\n  <span class=\"hljs-keyword\">const</span> sarif = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(fs.<span class=\"hljs-title function_\">readFileSync</span>(sarifPath, <span class=\"hljs-string\">&apos;utf8&apos;</span>));\n  <span class=\"hljs-keyword\">const</span> results = sarif.<span class=\"hljs-property\">runs</span>?.[<span class=\"hljs-number\">0</span>]?.<span class=\"hljs-property\">results</span> || [];\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;=== CodeQL Findings ===&apos;</span>);\n  <span class=\"hljs-keyword\">if</span> (results.<span class=\"hljs-property\">length</span> === <span class=\"hljs-number\">0</span>) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;No issues found by CodeQL.&apos;</span>);\n  } <span class=\"hljs-keyword\">else</span> {\n    results.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">res, idx</span>) =&gt;</span> {\n      <span class=\"hljs-keyword\">const</span> message = res.<span class=\"hljs-property\">message</span>?.<span class=\"hljs-property\">text</span> || <span class=\"hljs-string\">&apos;No message&apos;</span>;\n      <span class=\"hljs-keyword\">const</span> location = res.<span class=\"hljs-property\">locations</span>?.[<span class=\"hljs-number\">0</span>]?.<span class=\"hljs-property\">physicalLocation</span>?.<span class=\"hljs-property\">region</span> || {};\n      <span class=\"hljs-keyword\">const</span> startLine = location.<span class=\"hljs-property\">startLine</span> || <span class=\"hljs-string\">&apos;unknown line&apos;</span>;\n      <span class=\"hljs-keyword\">const</span> file = res.<span class=\"hljs-property\">locations</span>?.[<span class=\"hljs-number\">0</span>]?.<span class=\"hljs-property\">physicalLocation</span>?.<span class=\"hljs-property\">artifactLocation</span>?.<span class=\"hljs-property\">uri</span> || <span class=\"hljs-string\">&apos;unknown file&apos;</span>;\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`<span class=\"hljs-subst\">&#x24;{idx + <span class=\"hljs-number\">1</span>}</span>. <span class=\"hljs-subst\">&#x24;{res.ruleId || <span class=\"hljs-string\">&apos;unknown rule&apos;</span>}</span> - Severity: <span class=\"hljs-subst\">&#x24;{res.level || <span class=\"hljs-string\">&apos;unknown&apos;</span>}</span>`</span>);\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`   File: <span class=\"hljs-subst\">&#x24;{file}</span>:<span class=\"hljs-subst\">&#x24;{startLine}</span>`</span>);\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`   Message: <span class=\"hljs-subst\">&#x24;{message}</span>`</span>);\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;&apos;</span>);\n    });\n  }\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;&apos;</span>);\n}\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">main</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;=== Security Scan Combined Report ===\\n&apos;</span>);\n  <span class=\"hljs-title function_\">printNpmAuditSummary</span>();\n  <span class=\"hljs-title function_\">printQuickScanSummary</span>();\n  <span class=\"hljs-title function_\">printSemgrepSummary</span>();\n  <span class=\"hljs-title function_\">printCodeQLSummary</span>();\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;=== End of Report ===&apos;</span>);\n}\n<span class=\"hljs-title function_\">main</span>();\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1069,1183"}}],"payload":{"tag":"h3","lines":"1067,1068"}},{"content":"<code>examples/README.md</code>","children":[{"content":"<pre data-lines=\"1188,1194\"><code class=\"language-markdown\"><span class=\"hljs-section\"># Esempi di uso</span>\n<span class=\"hljs-section\">## 1. Eseguire la scansione rapida</span>\n<span class=\"hljs-code\">```bash\nnpm run quickscan\n</span></code></pre>","children":[],"payload":{"tag":"pre","lines":"1188,1194"}}],"payload":{"tag":"h3","lines":"1186,1187"}}],"payload":{"tag":"h2","lines":"943,944"}},{"content":"2. Eseguire il workflow completo (su GitHub Actions)","children":[{"content":"<code>npm audit</code>","children":[],"payload":{"tag":"li","lines":"1197,1198"}},{"content":"ricerca pattern con ripgrep","children":[],"payload":{"tag":"li","lines":"1198,1199"}},{"content":"script <code>quick-scan.js</code>","children":[],"payload":{"tag":"li","lines":"1199,1200"}},{"content":"Semgrep","children":[],"payload":{"tag":"li","lines":"1200,1201"}},{"content":"CodeQL","children":[],"payload":{"tag":"li","lines":"1201,1202"}}],"payload":{"tag":"h2","lines":"1195,1196"}},{"content":"3. Estrarre e visualizzare il report completo","children":[{"content":"<code>package.json</code>","children":[{"content":"<pre data-lines=\"1227,1250\"><code class=\"language-json\"><span class=\"hljs-punctuation\">{</span>\n  <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;security-scan-integration&quot;</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;version&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;1.0.0&quot;</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;description&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;Workflow e script per security scan integrati con GitHub Actions&quot;</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;main&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;tools/quick-scan.js&quot;</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;scripts&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n    <span class=\"hljs-attr\">&quot;quickscan&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;node tools/quick-scan.js&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-attr\">&quot;extract-report&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;node tools/extract-reports.js&quot;</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;keywords&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\n    <span class=\"hljs-string\">&quot;security&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;scan&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;github-actions&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;codeql&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;semgrep&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-string\">&quot;npm-audit&quot;</span>\n  <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;author&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;Generated by ChatGPT&quot;</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;license&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;MIT&quot;</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;devDependencies&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span>\n<span class=\"hljs-punctuation\">}</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1227,1250"}}],"payload":{"tag":"h3","lines":"1225,1226"}},{"content":"LICENSE (MIT)","children":[{"content":"<pre data-lines=\"1255,1274\"><code class=\"language-text\">MIT License\nCopyright (c) 2025\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the &quot;Software&quot;), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\nTHE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1255,1274"}}],"payload":{"tag":"h3","lines":"1253,1254"}}],"payload":{"tag":"h2","lines":"1202,1203"}},{"content":"4. Patch da applicare a un repo esistente","children":[{"content":"<pre data-lines=\"1281,1284\"><code class=\"language-bash\">git apply security-scan.patch\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1281,1284"}},{"content":"<pre data-lines=\"1285,1327\"><code class=\"language-diff\"><span class=\"hljs-comment\">diff --git a/package.json b/package.json</span>\n<span class=\"hljs-comment\">index e69de29..f3a9b30 100644</span>\n<span class=\"hljs-comment\">--- a/package.json</span>\n<span class=\"hljs-comment\">+++ b/package.json</span>\n<span class=\"hljs-meta\">@@ -1,6 +1,21 @@</span>\n<span class=\"hljs-addition\">+{</span>\n<span class=\"hljs-addition\">+  &quot;name&quot;: &quot;security-scan-integration&quot;,</span>\n<span class=\"hljs-addition\">+  &quot;version&quot;: &quot;1.0.0&quot;,</span>\n<span class=\"hljs-addition\">+  &quot;description&quot;: &quot;Workflow e script per security scan integrati con GitHub Actions&quot;,</span>\n<span class=\"hljs-addition\">+  &quot;main&quot;: &quot;tools/quick-scan.js&quot;,</span>\n<span class=\"hljs-addition\">+  &quot;scripts&quot;: {</span>\n<span class=\"hljs-addition\">+    &quot;quickscan&quot;: &quot;node tools/quick-scan.js&quot;,</span>\n<span class=\"hljs-addition\">+    &quot;extract-report&quot;: &quot;node tools/extract-reports.js&quot;</span>\n<span class=\"hljs-addition\">+  },</span>\n<span class=\"hljs-addition\">+  &quot;keywords&quot;: [</span>\n<span class=\"hljs-addition\">+    &quot;security&quot;,</span>\n<span class=\"hljs-addition\">+    &quot;scan&quot;,</span>\n<span class=\"hljs-addition\">+    &quot;github-actions&quot;,</span>\n<span class=\"hljs-addition\">+    &quot;codeql&quot;,</span>\n<span class=\"hljs-addition\">+    &quot;semgrep&quot;,</span>\n<span class=\"hljs-addition\">+    &quot;npm-audit&quot;</span>\n<span class=\"hljs-addition\">+  ],</span>\n<span class=\"hljs-addition\">+  &quot;author&quot;: &quot;Generated by ChatGPT&quot;,</span>\n<span class=\"hljs-addition\">+  &quot;license&quot;: &quot;MIT&quot;,</span>\n<span class=\"hljs-addition\">+  &quot;devDependencies&quot;: {}</span>\n<span class=\"hljs-addition\">+}</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-comment\">diff --git a/.gitignore b/.gitignore</span>\nnew file mode 100644\n<span class=\"hljs-comment\">--- /dev/null</span>\n<span class=\"hljs-comment\">+++ b/.gitignore</span>\n<span class=\"hljs-meta\">@@ -0,0 +1,7 @@</span>\n<span class=\"hljs-addition\">+node_modules/</span>\n<span class=\"hljs-addition\">+security-reports/</span>\n<span class=\"hljs-addition\">+*.log</span>\n<span class=\"hljs-addition\">+.env</span>\n<span class=\"hljs-addition\">+.DS_Store</span>\n<span class=\"hljs-addition\">+.vscode/</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-comment\">diff --git a/.github/workflows/security-scan.yml</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1285,1327"}},{"content":"<pre data-lines=\"1752,1754\"><code data-lines=\"1752,1754\"></code></pre>","children":[],"payload":{"tag":"pre","lines":"1752,1754"}}],"payload":{"tag":"h2","lines":"1277,1278"}},{"content":"///<br>\n\\\\","children":[],"payload":{"tag":"h2","lines":"1756,1759"}}],"payload":{"tag":"h1","lines":"852,853"}},{"content":"Output progetto completo","children":[{"content":"1. README.md","children":[{"content":"<code>tools/extract_reports.py</code>","children":[{"content":"<pre data-lines=\"1909,1972\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> json\n<span class=\"hljs-keyword\">import</span> os\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">extract_vulnerabilities_from_npm_audit</span>(<span class=\"hljs-params\">path</span>):\n    results = []\n    <span class=\"hljs-keyword\">try</span>:\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(path, <span class=\"hljs-string\">&apos;r&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            data = json.load(f)\n        advisories = data.get(<span class=\"hljs-string\">&apos;advisories&apos;</span>, {})\n        <span class=\"hljs-keyword\">for</span> key, adv <span class=\"hljs-keyword\">in</span> advisories.items():\n            results.append({\n                <span class=\"hljs-string\">&apos;module&apos;</span>: adv.get(<span class=\"hljs-string\">&apos;module_name&apos;</span>),\n                <span class=\"hljs-string\">&apos;severity&apos;</span>: adv.get(<span class=\"hljs-string\">&apos;severity&apos;</span>),\n                <span class=\"hljs-string\">&apos;title&apos;</span>: adv.get(<span class=\"hljs-string\">&apos;title&apos;</span>),\n                <span class=\"hljs-string\">&apos;url&apos;</span>: adv.get(<span class=\"hljs-string\">&apos;url&apos;</span>),\n            })\n    <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;Error reading npm audit report: <span class=\"hljs-subst\">{e}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">return</span> results\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">extract_bandit_issues</span>(<span class=\"hljs-params\">path</span>):\n    results = []\n    <span class=\"hljs-keyword\">try</span>:\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(path, <span class=\"hljs-string\">&apos;r&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            data = json.load(f)\n        results = data.get(<span class=\"hljs-string\">&apos;results&apos;</span>, [])\n    <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;Error reading bandit report: <span class=\"hljs-subst\">{e}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">return</span> results\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">extract_semgrep_issues</span>(<span class=\"hljs-params\">path</span>):\n    results = []\n    <span class=\"hljs-keyword\">try</span>:\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(path, <span class=\"hljs-string\">&apos;r&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            data = json.load(f)\n        results = data.get(<span class=\"hljs-string\">&apos;results&apos;</span>, [])\n    <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;Error reading semgrep report: <span class=\"hljs-subst\">{e}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">return</span> results\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">main</span>():\n    reports_dir = <span class=\"hljs-string\">&quot;security-reports&quot;</span>\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;=== Vulnerabilities and Security Findings ===\\n&quot;</span>)\n\n    npm_results = extract_vulnerabilities_from_npm_audit(os.path.join(reports_dir, <span class=\"hljs-string\">&apos;npm-audit.json&apos;</span>))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;\\nNPM Audit Results (<span class=\"hljs-subst\">{<span class=\"hljs-built_in\">len</span>(npm_results)}</span> vulnerabilities):&quot;</span>)\n    <span class=\"hljs-keyword\">for</span> r <span class=\"hljs-keyword\">in</span> npm_results:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot; - [<span class=\"hljs-subst\">{r[<span class=\"hljs-string\">&apos;severity&apos;</span>]}</span>] <span class=\"hljs-subst\">{r[<span class=\"hljs-string\">&apos;module&apos;</span>]}</span>: <span class=\"hljs-subst\">{r[<span class=\"hljs-string\">&apos;title&apos;</span>]}</span> (<span class=\"hljs-subst\">{r[<span class=\"hljs-string\">&apos;url&apos;</span>]}</span>)&quot;</span>)\n\n    bandit_results = extract_bandit_issues(os.path.join(reports_dir, <span class=\"hljs-string\">&apos;bandit-report.json&apos;</span>))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;\\nBandit (Python) Findings (<span class=\"hljs-subst\">{<span class=\"hljs-built_in\">len</span>(bandit_results)}</span> issues):&quot;</span>)\n    <span class=\"hljs-keyword\">for</span> r <span class=\"hljs-keyword\">in</span> bandit_results:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot; - <span class=\"hljs-subst\">{r.get(<span class=\"hljs-string\">&apos;filename&apos;</span>)}</span>:<span class=\"hljs-subst\">{r.get(<span class=\"hljs-string\">&apos;line_number&apos;</span>)}</span> - <span class=\"hljs-subst\">{r.get(<span class=\"hljs-string\">&apos;test_name&apos;</span>)}</span> - <span class=\"hljs-subst\">{r.get(<span class=\"hljs-string\">&apos;issue_text&apos;</span>)}</span>&quot;</span>)\n\n    semgrep_results = extract_semgrep_issues(os.path.join(reports_dir, <span class=\"hljs-string\">&apos;semgrep-report.json&apos;</span>))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;\\nSemgrep Findings (<span class=\"hljs-subst\">{<span class=\"hljs-built_in\">len</span>(semgrep_results)}</span> issues):&quot;</span>)\n    <span class=\"hljs-keyword\">for</span> r <span class=\"hljs-keyword\">in</span> semgrep_results:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot; - <span class=\"hljs-subst\">{r.get(<span class=\"hljs-string\">&apos;path&apos;</span>)}</span>:<span class=\"hljs-subst\">{r.get(<span class=\"hljs-string\">&apos;start&apos;</span>).get(<span class=\"hljs-string\">&apos;line&apos;</span>, <span class=\"hljs-string\">&apos;?&apos;</span>)}</span> - <span class=\"hljs-subst\">{r.get(<span class=\"hljs-string\">&apos;extra&apos;</span>).get(<span class=\"hljs-string\">&apos;severity&apos;</span>, <span class=\"hljs-string\">&apos;?&apos;</span>)}</span> - <span class=\"hljs-subst\">{r.get(<span class=\"hljs-string\">&apos;check_id&apos;</span>)}</span>&quot;</span>)\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\n    main()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1909,1972"}}],"payload":{"tag":"h3","lines":"1908,1909"}},{"content":"<code>tools/helpers.py</code>","children":[{"content":"<pre data-lines=\"1973,1979\"><code class=\"language-python\"><span class=\"hljs-comment\"># Helpers per estrazione report, estendibili</span>\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">format_issue</span>(<span class=\"hljs-params\">issue</span>):\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{issue.get(<span class=\"hljs-string\">&apos;path&apos;</span>)}</span>:<span class=\"hljs-subst\">{issue.get(<span class=\"hljs-string\">&apos;start&apos;</span>, {}</span>).get(&apos;line&apos;)} - <span class=\"hljs-subst\">{issue.get(<span class=\"hljs-string\">&apos;extra&apos;</span>, {}</span>).get(&apos;severity&apos;)} - <span class=\"hljs-subst\">{issue.get(<span class=\"hljs-string\">&apos;check_id&apos;</span>)}</span>&quot;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1973,1979"}}],"payload":{"tag":"h3","lines":"1972,1973"}},{"content":"<code>examples/example_usage.sh</code>","children":[{"content":"<pre data-lines=\"1980,1985\"><code class=\"language-bash\"><span class=\"hljs-meta\">#!/bin/bash</span>\n<span class=\"hljs-comment\"># Esempio rapido per eseguire lo script di estrazione report</span>\npython3 tools/extract_reports.py\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1980,1985"}}],"payload":{"tag":"h3","lines":"1979,1980"}},{"content":"<code>PATCH.md</code>","children":[{"content":"<pre data-lines=\"1986,2072\"><code class=\"language-diff\"><span class=\"hljs-comment\">--- A/.github/workflows/security-scan.yml</span>\n<span class=\"hljs-comment\">+++ B/.github/workflows/security-scan.yml</span>\n<span class=\"hljs-meta\">@@ -1,15 +1,70 @@</span>\n<span class=\"hljs-addition\">+name: Security Scan Multi-language</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+on:</span>\n<span class=\"hljs-addition\">+  push:</span>\n<span class=\"hljs-addition\">+    branches: [ &quot;main&quot; ]</span>\n<span class=\"hljs-addition\">+  pull_request:</span>\n<span class=\"hljs-addition\">+    branches: [ &quot;main&quot; ]</span>\n<span class=\"hljs-addition\">+  schedule:</span>\n<span class=\"hljs-addition\">+    - cron: &apos;0 2 * * 1&apos; # Ogni luned&#xec; alle 02:00</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+jobs:</span>\n<span class=\"hljs-addition\">+  security-scan:</span>\n<span class=\"hljs-addition\">+    runs-on: ubuntu-latest</span>\n<span class=\"hljs-addition\">+    permissions:</span>\n<span class=\"hljs-addition\">+      security-events: write</span>\n<span class=\"hljs-addition\">+      contents: read</span>\n<span class=\"hljs-addition\">+      actions: read</span>\n<span class=\"hljs-addition\">+      packages: read</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    steps:</span>\n<span class=\"hljs-addition\">+    - name: Checkout code</span>\n<span class=\"hljs-addition\">+      uses: actions/checkout@v4</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    # Setup Node.js and run npm audit for JS</span>\n<span class=\"hljs-addition\">+    - name: Setup Node.js</span>\n<span class=\"hljs-addition\">+      uses: actions/setup-node@v3</span>\n<span class=\"hljs-addition\">+      with:</span>\n<span class=\"hljs-addition\">+        node-version: &apos;18&apos;</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Install JS dependencies</span>\n<span class=\"hljs-addition\">+      run: npm install || echo &quot;No package.json found&quot;</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Run npm audit (JS only)</span>\n<span class=\"hljs-addition\">+      run: |</span>\n<span class=\"hljs-addition\">+        mkdir -p security-reports</span>\n<span class=\"hljs-addition\">+        npm audit --json &gt; security-reports/npm-audit.json || true</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    # Setup Python and run Bandit scan</span>\n<span class=\"hljs-addition\">+    - name: Setup Python</span>\n<span class=\"hljs-addition\">+      uses: actions/setup-python@v4</span>\n<span class=\"hljs-addition\">+      with:</span>\n<span class=\"hljs-addition\">+        python-version: &apos;3.x&apos;</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Install Bandit</span>\n<span class=\"hljs-addition\">+      run: pip install bandit</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Run Bandit scan (Python)</span>\n<span class=\"hljs-addition\">+      run: |</span>\n<span class=\"hljs-addition\">+        mkdir -p security-reports</span>\n<span class=\"hljs-addition\">+        bandit -r . -f json -o security-reports/bandit-report.json || true</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    # Run ripgrep to find secrets/keys in any language</span>\n<span class=\"hljs-addition\">+    - name: Run ripgrep for secrets</span>\n<span class=\"hljs-addition\">+      run: |</span>\n<span class=\"hljs-addition\">+        mkdir -p security-reports</span>\n<span class=\"hljs-addition\">+        rg --json --json-path &apos;.data.lines[0].text&apos; --json-seq --json-seq-delim &apos;\\n&apos; &apos;token|password|secret|apikey|api_key|access_key|auth&apos; &gt; security-reports/ripgrep-report.json || true</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    # Run Semgrep scan for multi-language</span>\n<span class=\"hljs-addition\">+    - name: Run semgrep scan</span>\n<span class=\"hljs-addition\">+      uses: returntocorp/semgrep-action@v1</span>\n<span class=\"hljs-addition\">+      with:</span>\n<span class=\"hljs-addition\">+        config: &quot;p/ci&quot;</span>\n<span class=\"hljs-addition\">+        output: security-reports/semgrep-report.json</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    # Initialize CodeQL for multi-language</span>\n<span class=\"hljs-addition\">+    - name: Initialize CodeQL</span>\n<span class=\"hljs-addition\">+      uses: github/codeql-action/init@v3</span>\n<span class=\"hljs-addition\">+      with:</span>\n<span class=\"hljs-addition\">+        languages: javascript, python, php, bash</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Perform CodeQL Analysis</span>\n<span class=\"hljs-addition\">+      uses: github/codeql-action/analyze@v3</span>\n<span class=\"hljs-addition\">+      with:</span>\n<span class=\"hljs-addition\">+        category: &apos;/language:javascript&apos;</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    # Upload all reports as artifact</span>\n<span class=\"hljs-addition\">+    - name: Upload Security Reports</span>\n<span class=\"hljs-addition\">+      uses: actions/upload-artifact@v3</span>\n<span class=\"hljs-addition\">+      with:</span>\n<span class=\"hljs-addition\">+        name: security-reports</span>\n<span class=\"hljs-addition\">+        path: security-reports/</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1986,2072"}}],"payload":{"tag":"h3","lines":"1985,1986"}},{"content":"<code>.gitignore</code>","children":[{"content":"<pre data-lines=\"2073,2082\"><code data-lines=\"2073,2082\">node_modules/\nsecurity-reports/\n__pycache__/\n*<span class=\"hljs-string\">.pyc</span>\n<span class=\"hljs-string\">.env</span>\n<span class=\"hljs-string\">.DS_Store</span>\n<span class=\"hljs-string\">.vscode/</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2073,2082"}}],"payload":{"tag":"h3","lines":"2072,2073"}},{"content":"<code>requirements.txt</code>","children":[{"content":"<pre data-lines=\"2083,2086\"><code data-lines=\"2083,2086\"><span class=\"hljs-attribute\">bandit</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2083,2086"}}],"payload":{"tag":"h3","lines":"2082,2083"}},{"content":"LICENSE","children":[{"content":"<pre data-lines=\"2087,2107\"><code class=\"language-text\">MIT License\n\nCopyright (c) 2025 [Tuo Nome o Organizzazione]\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the &quot;Software&quot;), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nTHE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2087,2107"}}],"payload":{"tag":"h3","lines":"2086,2087"}}],"payload":{"tag":"h2","lines":"1768,1769"}}],"payload":{"tag":"h1","lines":"1764,1765"}},{"content":"Istruzioni sintetiche per applicare la patch","children":[{"content":"Ecco cosa ti propongo:","children":[{"content":"1. <strong>Regole personalizzate Semgrep</strong>","children":[{"content":"<pre data-lines=\"2148,2165\"><code class=\"language-yaml\"><span class=\"hljs-attr\">rules:</span>\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">hardcoded-secret</span>\n    <span class=\"hljs-attr\">patterns:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">pattern-either:</span>\n          <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">|\n              api_key = &quot;&#x24;SECRET&quot;\n</span>          <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">|\n              password = &quot;&#x24;SECRET&quot;\n</span>          <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">|\n              token = &quot;&#x24;SECRET&quot;\n</span>    <span class=\"hljs-attr\">message:</span> <span class=\"hljs-string\">&quot;Hardcoded secret found. Consider using environment variables or secret managers.&quot;</span>\n    <span class=\"hljs-attr\">severity:</span> <span class=\"hljs-string\">ERROR</span>\n    <span class=\"hljs-attr\">languages:</span> [<span class=\"hljs-string\">python</span>, <span class=\"hljs-string\">javascript</span>, <span class=\"hljs-string\">php</span>, <span class=\"hljs-string\">bash</span>]\n    <span class=\"hljs-attr\">metadata:</span>\n      <span class=\"hljs-attr\">category:</span> <span class=\"hljs-string\">security</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2148,2165"}}],"payload":{"tag":"h3","lines":"2141,2142"}},{"content":"2. <strong>Scanner aggiuntivi</strong>","children":[{"content":"<strong>Trivy</strong>: scanner container e file system, ottimo per scovare segreti e vulnerabilit&#xe0;","children":[],"payload":{"tag":"li","lines":"2166,2167"}},{"content":"<strong>PHPStan</strong>: static analysis per PHP (codice potenzialmente vulnerabile)","children":[],"payload":{"tag":"li","lines":"2167,2168"}},{"content":"<strong>ShellCheck</strong>: linting bash script per errori e potenziali rischi","children":[],"payload":{"tag":"li","lines":"2168,2169"}}],"payload":{"tag":"h3","lines":"2165,2166"}},{"content":"3. <strong>Workflow aggiornato</strong>","children":[],"payload":{"tag":"h3","lines":"2169,2170"}},{"content":"4. <strong>Script aggiornati</strong>","children":[],"payload":{"tag":"h3","lines":"2171,2172"}}],"payload":{"tag":"h2","lines":"2140,2141"}}],"payload":{"tag":"h1","lines":"2107,2108"}},{"content":"Progetto completo aggiornato (snippet essenziali)","children":[{"content":"<code>.github/workflows/security-scan.yml</code>","children":[{"content":"<pre data-lines=\"2175,2260\"><code class=\"language-yaml\"><span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Security</span> <span class=\"hljs-string\">Scan</span> <span class=\"hljs-string\">Multi-language</span> <span class=\"hljs-string\">Advanced</span>\n\n<span class=\"hljs-attr\">on:</span>\n  <span class=\"hljs-attr\">push:</span>\n    <span class=\"hljs-attr\">branches:</span> [ <span class=\"hljs-string\">&quot;main&quot;</span> ]\n  <span class=\"hljs-attr\">pull_request:</span>\n    <span class=\"hljs-attr\">branches:</span> [ <span class=\"hljs-string\">&quot;main&quot;</span> ]\n  <span class=\"hljs-attr\">schedule:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">cron:</span> <span class=\"hljs-string\">&apos;0 3 * * 1&apos;</span> <span class=\"hljs-comment\"># Ogni luned&#xec; 03:00</span>\n\n<span class=\"hljs-attr\">jobs:</span>\n  <span class=\"hljs-attr\">security-scan:</span>\n    <span class=\"hljs-attr\">runs-on:</span> <span class=\"hljs-string\">ubuntu-latest</span>\n    <span class=\"hljs-attr\">permissions:</span>\n      <span class=\"hljs-attr\">security-events:</span> <span class=\"hljs-string\">write</span>\n      <span class=\"hljs-attr\">contents:</span> <span class=\"hljs-string\">read</span>\n      <span class=\"hljs-attr\">actions:</span> <span class=\"hljs-string\">read</span>\n      <span class=\"hljs-attr\">packages:</span> <span class=\"hljs-string\">read</span>\n\n    <span class=\"hljs-attr\">steps:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Checkout</span> <span class=\"hljs-string\">code</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/checkout@v4</span>\n\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Setup</span> <span class=\"hljs-string\">Node.js</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/setup-node@v3</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">node-version:</span> <span class=\"hljs-string\">&apos;18&apos;</span>\n\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Install</span> <span class=\"hljs-string\">JS</span> <span class=\"hljs-string\">dependencies</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">npm</span> <span class=\"hljs-string\">install</span> <span class=\"hljs-string\">||</span> <span class=\"hljs-string\">echo</span> <span class=\"hljs-string\">&quot;No package.json found&quot;</span>\n\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">npm</span> <span class=\"hljs-string\">audit</span> <span class=\"hljs-string\">(JS</span> <span class=\"hljs-string\">only)</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|\n        mkdir -p security-reports\n        npm audit --json &gt; security-reports/npm-audit.json || true\n</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Setup</span> <span class=\"hljs-string\">Python</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/setup-python@v4</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">python-version:</span> <span class=\"hljs-string\">&apos;3.x&apos;</span>\n\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Install</span> <span class=\"hljs-string\">Bandit,</span> <span class=\"hljs-string\">PHPStan,</span> <span class=\"hljs-string\">ShellCheck</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|\n        pip install bandit\n        sudo apt-get install -y shellcheck php-cli php-xml php-mbstring\n        composer global require phpstan/phpstan || echo &quot;Composer not found or PHPStan already installed&quot;\n</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">Bandit</span> <span class=\"hljs-string\">scan</span> <span class=\"hljs-string\">(Python)</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">bandit</span> <span class=\"hljs-string\">-r</span> <span class=\"hljs-string\">.</span> <span class=\"hljs-string\">-f</span> <span class=\"hljs-string\">json</span> <span class=\"hljs-string\">-o</span> <span class=\"hljs-string\">security-reports/bandit-report.json</span> <span class=\"hljs-string\">||</span> <span class=\"hljs-literal\">true</span>\n\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">ShellCheck</span> <span class=\"hljs-string\">(Bash</span> <span class=\"hljs-string\">scripts)</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|\n        mkdir -p security-reports/shellcheck\n        find . -name &apos;*.sh&apos; -exec shellcheck -f json -o security-reports/shellcheck/{}.json {} \\; || true\n</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">PHPStan</span> <span class=\"hljs-string\">(PHP)</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|\n        ~/.composer/vendor/bin/phpstan analyse --error-format=json &gt; security-reports/phpstan-report.json || true\n</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">ripgrep</span> <span class=\"hljs-string\">for</span> <span class=\"hljs-string\">secrets</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|\n        mkdir -p security-reports\n        rg --json --json-path &apos;.data.lines[0].text&apos; --json-seq --json-seq-delim &apos;\\n&apos; &apos;token|password|secret|apikey|api_key|access_key|auth&apos; &gt; security-reports/ripgrep-report.json || true\n</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">semgrep</span> <span class=\"hljs-string\">scan</span> <span class=\"hljs-string\">with</span> <span class=\"hljs-string\">custom</span> <span class=\"hljs-string\">rules</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">returntocorp/semgrep-action@v1</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">config:</span> <span class=\"hljs-string\">&quot;./semgrep-rules&quot;</span>\n        <span class=\"hljs-attr\">output:</span> <span class=\"hljs-string\">security-reports/semgrep-report.json</span>\n\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Initialize</span> <span class=\"hljs-string\">CodeQL</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">github/codeql-action/init@v3</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">languages:</span> <span class=\"hljs-string\">javascript,</span> <span class=\"hljs-string\">python,</span> <span class=\"hljs-string\">php,</span> <span class=\"hljs-string\">bash</span>\n\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Perform</span> <span class=\"hljs-string\">CodeQL</span> <span class=\"hljs-string\">Analysis</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">github/codeql-action/analyze@v3</span>\n\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Upload</span> <span class=\"hljs-string\">Security</span> <span class=\"hljs-string\">Reports</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/upload-artifact@v3</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">security-reports</span>\n        <span class=\"hljs-attr\">path:</span> <span class=\"hljs-string\">security-reports/</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2175,2260"}}],"payload":{"tag":"h2","lines":"2174,2175"}},{"content":"<code>semgrep-rules/hardcoded-secrets.yaml</code>","children":[{"content":"<pre data-lines=\"2261,2279\"><code class=\"language-yaml\"><span class=\"hljs-attr\">rules:</span>\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">hardcoded-secret</span>\n    <span class=\"hljs-attr\">patterns:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">pattern-either:</span>\n          <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">api_key</span> <span class=\"hljs-string\">=</span> <span class=\"hljs-string\">&quot;&#x24;SECRET&quot;</span>\n          <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">password</span> <span class=\"hljs-string\">=</span> <span class=\"hljs-string\">&quot;&#x24;SECRET&quot;</span>\n          <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">token</span> <span class=\"hljs-string\">=</span> <span class=\"hljs-string\">&quot;&#x24;SECRET&quot;</span>\n          <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">| \n              const API_KEY = &quot;&#x24;SECRET&quot;\n</span>          <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">| \n              export SECRET=*\n</span>    <span class=\"hljs-attr\">message:</span> <span class=\"hljs-string\">&quot;Hardcoded secret found. Consider environment variables or secret managers.&quot;</span>\n    <span class=\"hljs-attr\">severity:</span> <span class=\"hljs-string\">ERROR</span>\n    <span class=\"hljs-attr\">languages:</span> [<span class=\"hljs-string\">python</span>, <span class=\"hljs-string\">javascript</span>, <span class=\"hljs-string\">php</span>, <span class=\"hljs-string\">bash</span>]\n    <span class=\"hljs-attr\">metadata:</span>\n      <span class=\"hljs-attr\">category:</span> <span class=\"hljs-string\">security</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2261,2279"}}],"payload":{"tag":"h2","lines":"2260,2261"}},{"content":"<code>tools/extract_reports.py</code> (aggiunto estrazione PHPStan e ShellCheck)","children":[{"content":"<pre data-lines=\"2280,2328\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> json\n<span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">import</span> glob\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">extract_phpstan_issues</span>(<span class=\"hljs-params\">path</span>):\n    results = []\n    <span class=\"hljs-keyword\">try</span>:\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(path, <span class=\"hljs-string\">&apos;r&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            data = json.load(f)\n        results = data.get(<span class=\"hljs-string\">&apos;files&apos;</span>, {}).values()\n    <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;Error reading PHPStan report: <span class=\"hljs-subst\">{e}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">return</span> results\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">extract_shellcheck_issues</span>(<span class=\"hljs-params\">dir_path</span>):\n    issues = []\n    <span class=\"hljs-keyword\">try</span>:\n        files = glob.glob(os.path.join(dir_path, <span class=\"hljs-string\">&apos;**/*.json&apos;</span>), recursive=<span class=\"hljs-literal\">True</span>)\n        <span class=\"hljs-keyword\">for</span> file <span class=\"hljs-keyword\">in</span> files:\n            <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(file, <span class=\"hljs-string\">&apos;r&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n                data = json.load(f)\n                issues.extend(data)\n    <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;Error reading ShellCheck reports: <span class=\"hljs-subst\">{e}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">return</span> issues\n\n<span class=\"hljs-comment\">#... (resto codice estrazione come prima)</span>\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">main</span>():\n    reports_dir = <span class=\"hljs-string\">&quot;security-reports&quot;</span>\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;=== Vulnerabilities and Security Findings ===\\n&quot;</span>)\n\n    <span class=\"hljs-comment\"># Esempio chiamate estese:</span>\n    phpstan_issues = extract_phpstan_issues(os.path.join(reports_dir, <span class=\"hljs-string\">&apos;phpstan-report.json&apos;</span>))\n    shellcheck_issues = extract_shellcheck_issues(os.path.join(reports_dir, <span class=\"hljs-string\">&apos;shellcheck&apos;</span>))\n\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;\\nPHPStan Issues: <span class=\"hljs-subst\">{<span class=\"hljs-built_in\">len</span>(phpstan_issues)}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">for</span> file_issues <span class=\"hljs-keyword\">in</span> phpstan_issues:\n        <span class=\"hljs-keyword\">for</span> error <span class=\"hljs-keyword\">in</span> file_issues.get(<span class=\"hljs-string\">&apos;errors&apos;</span>, []):\n            <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot; - <span class=\"hljs-subst\">{error}</span>&quot;</span>)\n\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;\\nShellCheck Issues: <span class=\"hljs-subst\">{<span class=\"hljs-built_in\">len</span>(shellcheck_issues)}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">for</span> issue <span class=\"hljs-keyword\">in</span> shellcheck_issues:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot; - <span class=\"hljs-subst\">{issue.get(<span class=\"hljs-string\">&apos;file&apos;</span>)}</span>:<span class=\"hljs-subst\">{issue.get(<span class=\"hljs-string\">&apos;line&apos;</span>)}</span> - <span class=\"hljs-subst\">{issue.get(<span class=\"hljs-string\">&apos;message&apos;</span>)}</span>&quot;</span>)\n\n    <span class=\"hljs-comment\"># (continua con estrazioni precedenti...)</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2280,2328"}}],"payload":{"tag":"h2","lines":"2279,2280"}}],"payload":{"tag":"h1","lines":"2173,2174"}},{"content":"Ulteriori consigli e personalizzazioni","children":[{"content":"Puoi ampliare la cartella <code>semgrep-rules/</code> con pi&#xf9; regole mirate ai tuoi rischi specifici","children":[],"payload":{"tag":"li","lines":"2329,2330"}},{"content":"Il workflow pu&#xf2; essere parametrizzato per scansionare branch o tag specifici","children":[],"payload":{"tag":"li","lines":"2330,2331"}},{"content":"Puoi aggiungere notifiche (Slack, email) per alert in caso di vulnerabilit&#xe0; critiche<br>\nOppure ti posso fornire i singoli file per integrazione.<br>\n///<br>\n\\\\","children":[],"payload":{"tag":"li","lines":"2331,2335"}}],"payload":{"tag":"h1","lines":"2328,2329"}},{"content":"tgfeed-security-enhancer","children":[{"content":"1. README.md","children":[{"content":"Configurazione","children":[{"content":"Modifica il file <code>.github/workflows/security-scan.yml</code> per specificare branch/tag da scansionare (di default: <code>main</code>)","children":[],"payload":{"tag":"li","lines":"2375,2376"}},{"content":"Personalizza o aggiungi regole Semgrep nella cartella <code>semgrep-rules/</code>","children":[],"payload":{"tag":"li","lines":"2376,2377"}},{"content":"Installa dipendenze necessarie se vuoi eseguire scansioni localmente","children":[],"payload":{"tag":"li","lines":"2377,2379"}}],"payload":{"tag":"h3","lines":"2373,2374"}},{"content":"Esecuzione","children":[{"content":"<pre data-lines=\"2385,2388\"><code class=\"language-bash\">python3 tools/extract_reports.py\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2385,2388"}}],"payload":{"tag":"h3","lines":"2379,2380"}}],"payload":{"tag":"h2","lines":"2338,2339"}},{"content":"Tecnologie utilizzate","children":[{"content":"<a href=\"https://github.com/features/actions\">GitHub Actions</a>","children":[],"payload":{"tag":"li","lines":"2391,2392"}},{"content":"<a href=\"https://codeql.github.com/\">CodeQL</a>","children":[],"payload":{"tag":"li","lines":"2392,2393"}},{"content":"<a href=\"https://semgrep.dev/\">Semgrep</a>","children":[],"payload":{"tag":"li","lines":"2393,2394"}},{"content":"<a href=\"https://bandit.readthedocs.io/en/latest/\">Bandit</a>","children":[],"payload":{"tag":"li","lines":"2394,2395"}},{"content":"<a href=\"https://phpstan.org/\">PHPStan</a>","children":[],"payload":{"tag":"li","lines":"2395,2396"}},{"content":"<a href=\"https://www.shellcheck.net/\">ShellCheck</a>","children":[],"payload":{"tag":"li","lines":"2396,2397"}},{"content":"<a href=\"https://github.com/BurntSushi/ripgrep\">Ripgrep</a>","children":[],"payload":{"tag":"li","lines":"2397,2399"}}],"payload":{"tag":"h2","lines":"2389,2390"}},{"content":"Struttura del progetto","children":[{"content":"<pre data-lines=\"2403,2423\"><code data-lines=\"2403,2423\">tgfeed-security-enhancer<span class=\"hljs-symbol\">/</span>\n&#x251c;&#x2500;&#x2500; .github<span class=\"hljs-symbol\">/</span>\n&#x2502;   &#x2514;&#x2500;&#x2500; workflows<span class=\"hljs-symbol\">/</span>\n&#x2502;       &#x2514;&#x2500;&#x2500; security-scan.yml\n&#x251c;&#x2500;&#x2500; patches<span class=\"hljs-symbol\">/</span>\n&#x2502;   &#x2514;&#x2500;&#x2500; add-security-scan.patch\n&#x251c;&#x2500;&#x2500; semgrep-rules<span class=\"hljs-symbol\">/</span>\n&#x2502;   &#x251c;&#x2500;&#x2500; hardcoded-secrets.yaml\n&#x2502;   &#x251c;&#x2500;&#x2500; dangerous-functions.yaml\n&#x2502;   &#x251c;&#x2500;&#x2500; logging-sensitive-data.yaml\n&#x2502;   &#x2514;&#x2500;&#x2500; README.md\n&#x251c;&#x2500;&#x2500; security-reports<span class=\"hljs-symbol\">/</span>    <span class=\"hljs-comment\"># generata da workflow</span>\n&#x251c;&#x2500;&#x2500; tools<span class=\"hljs-symbol\">/</span>\n&#x2502;   &#x251c;&#x2500;&#x2500; extract_reports.py\n&#x2502;   &#x2514;&#x2500;&#x2500; README.md\n&#x251c;&#x2500;&#x2500; .gitignore\n&#x251c;&#x2500;&#x2500; LICENSE\n&#x2514;&#x2500;&#x2500; README.md\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2403,2423"}}],"payload":{"tag":"h2","lines":"2401,2402"}},{"content":"Contatti","children":[],"payload":{"tag":"h2","lines":"2426,2427"}}],"payload":{"tag":"h1","lines":"2335,2336"}},{"content":"Fine README.md","children":[{"content":"3. <code>semgrep-rules/README.md</code>","children":[{"content":"<code>dangerous-functions.yaml</code>","children":[{"content":"<pre data-lines=\"2564,2590\"><code class=\"language-yaml\"><span class=\"hljs-attr\">rules:</span>\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">dangerous-eval</span>\n    <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">eval(...)</span>\n    <span class=\"hljs-attr\">message:</span> <span class=\"hljs-string\">&quot;Avoid using eval due to code injection risk.&quot;</span>\n    <span class=\"hljs-attr\">severity:</span> <span class=\"hljs-string\">ERROR</span>\n    <span class=\"hljs-attr\">languages:</span> [<span class=\"hljs-string\">javascript</span>, <span class=\"hljs-string\">php</span>, <span class=\"hljs-string\">python</span>]\n    <span class=\"hljs-attr\">metadata:</span>\n      <span class=\"hljs-attr\">category:</span> <span class=\"hljs-string\">security</span>\n\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">dangerous-exec</span>\n    <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">exec(...)</span>\n    <span class=\"hljs-attr\">message:</span> <span class=\"hljs-string\">&quot;Use of exec can lead to command injection. Validate inputs.&quot;</span>\n    <span class=\"hljs-attr\">severity:</span> <span class=\"hljs-string\">ERROR</span>\n    <span class=\"hljs-attr\">languages:</span> [<span class=\"hljs-string\">python</span>]\n    <span class=\"hljs-attr\">metadata:</span>\n      <span class=\"hljs-attr\">category:</span> <span class=\"hljs-string\">security</span>\n\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">dangerous-system</span>\n    <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">system(...)</span>\n    <span class=\"hljs-attr\">message:</span> <span class=\"hljs-string\">&quot;Use of system calls can be dangerous. Validate inputs.&quot;</span>\n    <span class=\"hljs-attr\">severity:</span> <span class=\"hljs-string\">WARNING</span>\n    <span class=\"hljs-attr\">languages:</span> [<span class=\"hljs-string\">php</span>]\n    <span class=\"hljs-attr\">metadata:</span>\n      <span class=\"hljs-attr\">category:</span> <span class=\"hljs-string\">security</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2564,2590"}}],"payload":{"tag":"h3","lines":"2563,2564"}},{"content":"<code>logging-sensitive-data.yaml</code>","children":[{"content":"<pre data-lines=\"2591,2614\"><code class=\"language-yaml\"><span class=\"hljs-attr\">rules:</span>\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">sensitive-data-logging</span>\n    <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">|\n      console.log(&#x24;SENSITIVE)\n</span>    <span class=\"hljs-attr\">message:</span> <span class=\"hljs-string\">&quot;Logging sensitive data detected.&quot;</span>\n    <span class=\"hljs-attr\">severity:</span> <span class=\"hljs-string\">WARNING</span>\n    <span class=\"hljs-attr\">languages:</span> [<span class=\"hljs-string\">javascript</span>]\n\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">python-logging-sensitive</span>\n    <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">|\n      logging.info(&#x24;SENSITIVE)\n</span>    <span class=\"hljs-attr\">message:</span> <span class=\"hljs-string\">&quot;Logging potentially sensitive data.&quot;</span>\n    <span class=\"hljs-attr\">severity:</span> <span class=\"hljs-string\">WARNING</span>\n    <span class=\"hljs-attr\">languages:</span> [<span class=\"hljs-string\">python</span>]\n\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">id:</span> <span class=\"hljs-string\">php-logging-sensitive</span>\n    <span class=\"hljs-attr\">pattern:</span> <span class=\"hljs-string\">|\n      error_log(&#x24;SENSITIVE)\n</span>    <span class=\"hljs-attr\">message:</span> <span class=\"hljs-string\">&quot;Logging potentially sensitive data.&quot;</span>\n    <span class=\"hljs-attr\">severity:</span> <span class=\"hljs-string\">WARNING</span>\n    <span class=\"hljs-attr\">languages:</span> [<span class=\"hljs-string\">php</span>]\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2591,2614"}}],"payload":{"tag":"h3","lines":"2590,2591"}}],"payload":{"tag":"h2","lines":"2518,2519"}},{"content":"5. <code>tools/extract_reports.py</code>","children":[{"content":"<pre data-lines=\"2615,2726\"><code class=\"language-python\"><span class=\"hljs-comment\">#!/usr/bin/env python3</span>\n\n<span class=\"hljs-keyword\">import</span> json\n<span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">import</span> glob\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">extract_semgrep_issues</span>(<span class=\"hljs-params\">path</span>):\n    issues = []\n    <span class=\"hljs-keyword\">try</span>:\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(path, <span class=\"hljs-string\">&apos;r&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            data = json.load(f)\n        <span class=\"hljs-keyword\">for</span> result <span class=\"hljs-keyword\">in</span> data.get(<span class=\"hljs-string\">&apos;results&apos;</span>, []):\n            issues.append({\n                <span class=\"hljs-string\">&apos;check_id&apos;</span>: result.get(<span class=\"hljs-string\">&apos;check_id&apos;</span>),\n                <span class=\"hljs-string\">&apos;message&apos;</span>: result.get(<span class=\"hljs-string\">&apos;extra&apos;</span>, {}).get(<span class=\"hljs-string\">&apos;message&apos;</span>),\n                <span class=\"hljs-string\">&apos;file&apos;</span>: result.get(<span class=\"hljs-string\">&apos;path&apos;</span>),\n                <span class=\"hljs-string\">&apos;start_line&apos;</span>: result.get(<span class=\"hljs-string\">&apos;start&apos;</span>, {}).get(<span class=\"hljs-string\">&apos;line&apos;</span>),\n                <span class=\"hljs-string\">&apos;end_line&apos;</span>: result.get(<span class=\"hljs-string\">&apos;end&apos;</span>, {}).get(<span class=\"hljs-string\">&apos;line&apos;</span>),\n                <span class=\"hljs-string\">&apos;severity&apos;</span>: result.get(<span class=\"hljs-string\">&apos;severity&apos;</span>),\n            })\n    <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;Errore nel parsing del report Semgrep: <span class=\"hljs-subst\">{e}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">return</span> issues\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">extract_bandit_issues</span>(<span class=\"hljs-params\">path</span>):\n    issues = []\n    <span class=\"hljs-keyword\">try</span>:\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(path, <span class=\"hljs-string\">&apos;r&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            data = json.load(f)\n        <span class=\"hljs-keyword\">for</span> issue <span class=\"hljs-keyword\">in</span> data.get(<span class=\"hljs-string\">&apos;results&apos;</span>, []):\n            issues.append({\n                <span class=\"hljs-string\">&apos;filename&apos;</span>: issue.get(<span class=\"hljs-string\">&apos;filename&apos;</span>),\n                <span class=\"hljs-string\">&apos;issue_text&apos;</span>: issue.get(<span class=\"hljs-string\">&apos;issue_text&apos;</span>),\n                <span class=\"hljs-string\">&apos;severity&apos;</span>: issue.get(<span class=\"hljs-string\">&apos;issue_severity&apos;</span>),\n                <span class=\"hljs-string\">&apos;line_number&apos;</span>: issue.get(<span class=\"hljs-string\">&apos;line_number&apos;</span>),\n            })\n    <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;Errore nel parsing del report Bandit: <span class=\"hljs-subst\">{e}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">return</span> issues\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">extract_phpstan_issues</span>(<span class=\"hljs-params\">path</span>):\n    issues = []\n    <span class=\"hljs-keyword\">try</span>:\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(path, <span class=\"hljs-string\">&apos;r&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            data = json.load(f)\n        <span class=\"hljs-comment\"># PHPStan report struttura base</span>\n        <span class=\"hljs-keyword\">for</span> file_path, file_data <span class=\"hljs-keyword\">in</span> data.get(<span class=\"hljs-string\">&apos;files&apos;</span>, {}).items():\n            <span class=\"hljs-keyword\">for</span> error <span class=\"hljs-keyword\">in</span> file_data.get(<span class=\"hljs-string\">&apos;errors&apos;</span>, []):\n                issues.append({\n                    <span class=\"hljs-string\">&apos;file&apos;</span>: file_path,\n                    <span class=\"hljs-string\">&apos;message&apos;</span>: error,\n                })\n    <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;Errore nel parsing del report PHPStan: <span class=\"hljs-subst\">{e}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">return</span> issues\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">extract_shellcheck_issues</span>(<span class=\"hljs-params\">dir_path</span>):\n    issues = []\n    <span class=\"hljs-keyword\">try</span>:\n        files = glob.glob(os.path.join(dir_path, <span class=\"hljs-string\">&apos;**/*.json&apos;</span>), recursive=<span class=\"hljs-literal\">True</span>)\n        <span class=\"hljs-keyword\">for</span> file <span class=\"hljs-keyword\">in</span> files:\n            <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(file, <span class=\"hljs-string\">&apos;r&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n                data = json.load(f)\n                issues.extend(data)\n    <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;Errore nel parsing dei report ShellCheck: <span class=\"hljs-subst\">{e}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">return</span> issues\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">extract_ripgrep_issues</span>(<span class=\"hljs-params\">path</span>):\n    issues = []\n    <span class=\"hljs-keyword\">try</span>:\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(path, <span class=\"hljs-string\">&apos;r&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            <span class=\"hljs-keyword\">for</span> line <span class=\"hljs-keyword\">in</span> f:\n                <span class=\"hljs-keyword\">if</span> line.strip():\n                    issues.append(json.loads(line))\n    <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;Errore nel parsing del report Ripgrep: <span class=\"hljs-subst\">{e}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">return</span> issues\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">main</span>():\n    reports_dir = <span class=\"hljs-string\">&quot;security-reports&quot;</span>\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;\\n=== Vulnerabilities and Security Findings ===\\n&quot;</span>)\n\n    semgrep = extract_semgrep_issues(os.path.join(reports_dir, <span class=\"hljs-string\">&quot;semgrep-report.json&quot;</span>))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;Semgrep issues: <span class=\"hljs-subst\">{<span class=\"hljs-built_in\">len</span>(semgrep)}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> semgrep:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;- [<span class=\"hljs-subst\">{i[<span class=\"hljs-string\">&apos;severity&apos;</span>]}</span>] <span class=\"hljs-subst\">{i[<span class=\"hljs-string\">&apos;file&apos;</span>]}</span>:<span class=\"hljs-subst\">{i[<span class=\"hljs-string\">&apos;start_line&apos;</span>]}</span> - <span class=\"hljs-subst\">{i[<span class=\"hljs-string\">&apos;message&apos;</span>]}</span> (<span class=\"hljs-subst\">{i[<span class=\"hljs-string\">&apos;check_id&apos;</span>]}</span>)&quot;</span>)\n\n    bandit = extract_bandit_issues(os.path.join(reports_dir, <span class=\"hljs-string\">&quot;bandit-report.json&quot;</span>))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;\\nBandit issues: <span class=\"hljs-subst\">{<span class=\"hljs-built_in\">len</span>(bandit)}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> bandit:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;- [<span class=\"hljs-subst\">{i[<span class=\"hljs-string\">&apos;severity&apos;</span>]}</span>] <span class=\"hljs-subst\">{i[<span class=\"hljs-string\">&apos;filename&apos;</span>]}</span>:<span class=\"hljs-subst\">{i[<span class=\"hljs-string\">&apos;line_number&apos;</span>]}</span> - <span class=\"hljs-subst\">{i[<span class=\"hljs-string\">&apos;issue_text&apos;</span>]}</span>&quot;</span>)\n\n    phpstan = extract_phpstan_issues(os.path.join(reports_dir, <span class=\"hljs-string\">&quot;phpstan-report.json&quot;</span>))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;\\nPHPStan issues: <span class=\"hljs-subst\">{<span class=\"hljs-built_in\">len</span>(phpstan)}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> phpstan:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;- <span class=\"hljs-subst\">{i[<span class=\"hljs-string\">&apos;file&apos;</span>]}</span> - <span class=\"hljs-subst\">{i[<span class=\"hljs-string\">&apos;message&apos;</span>]}</span>&quot;</span>)\n\n    shellcheck = extract_shellcheck_issues(os.path.join(reports_dir, <span class=\"hljs-string\">&quot;shellcheck&quot;</span>))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;\\nShellCheck issues: <span class=\"hljs-subst\">{<span class=\"hljs-built_in\">len</span>(shellcheck)}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> shellcheck:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;- <span class=\"hljs-subst\">{i.get(<span class=\"hljs-string\">&apos;file&apos;</span>)}</span>:<span class=\"hljs-subst\">{i.get(<span class=\"hljs-string\">&apos;line&apos;</span>)}</span> - <span class=\"hljs-subst\">{i.get(<span class=\"hljs-string\">&apos;message&apos;</span>)}</span>&quot;</span>)\n\n    ripgrep = extract_ripgrep_issues(os.path.join(reports_dir, <span class=\"hljs-string\">&quot;ripgrep-report.json&quot;</span>))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;\\nRipgrep findings (possible secrets): <span class=\"hljs-subst\">{<span class=\"hljs-built_in\">len</span>(ripgrep)}</span>&quot;</span>)\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> ripgrep:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;- <span class=\"hljs-subst\">{i.get(<span class=\"hljs-string\">&apos;data&apos;</span>, {}</span>).get(&apos;lines&apos;, [<span class=\"hljs-subst\">{}</span>])[0].get(&apos;text&apos;, &apos;&apos;).strip()}&quot;</span>)\n\n<span class=\"hljs-keyword\">if</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2615,2726"}},{"content":"<pre data-lines=\"2728,2735\"><code data-lines=\"2728,2735\">\n<span class=\"hljs-meta\">---\n</span>\n<span class=\"hljs-comment\">## 6. `.gitignore`</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2728,2735"}}],"payload":{"tag":"h2","lines":"2614,2615"}}],"payload":{"tag":"h1","lines":"2432,2433"}},{"content":"Logs","children":[],"payload":{"tag":"h1","lines":"2735,2736"}},{"content":"Dependency directories","children":[],"payload":{"tag":"h1","lines":"2739,2740"}},{"content":"Security reports","children":[],"payload":{"tag":"h1","lines":"2744,2745"}},{"content":"Environment files","children":[],"payload":{"tag":"h1","lines":"2746,2747"}},{"content":"MacOS","children":[],"payload":{"tag":"h1","lines":"2750,2751"}},{"content":"Python virtual environments","children":[{"content":"<pre data-lines=\"2755,2762\"><code data-lines=\"2755,2762\">\n<span class=\"hljs-meta\">---\n</span>\n<span class=\"hljs-comment\">## 7. LICENSE (MIT)</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2755,2762"}},{"content":"<pre data-lines=\"2771,2992\"><code data-lines=\"2771,2992\">\n<span class=\"hljs-comment\">---</span>\n\n## 8. Patch `patches/add-security-scan.patch`\n\n```diff\n<span class=\"hljs-comment\">diff --git a/.github/workflows/security-scan.yml b/.github/workflows/security-scan.yml</span>\nnew file mode 100644\n<span class=\"hljs-comment\">index 0000000..abcdef1</span>\n<span class=\"hljs-comment\">--- /dev/null</span>\n<span class=\"hljs-comment\">+++ b/.github/workflows/security-scan.yml</span>\n<span class=\"hljs-meta\">@@ -0,0 +1,63 @@</span>\n<span class=\"hljs-addition\">+name: Security Scan Multi-language Advanced</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+on:</span>\n<span class=\"hljs-addition\">+  push:</span>\n<span class=\"hljs-addition\">+    branches: [ &quot;main&quot;, &quot;develop&quot; ]</span>\n<span class=\"hljs-addition\">+  pull_request:</span>\n<span class=\"hljs-addition\">+    branches: [ &quot;main&quot;, &quot;develop&quot; ]</span>\n<span class=\"hljs-addition\">+  workflow_dispatch:</span>\n<span class=\"hljs-addition\">+  schedule:</span>\n<span class=\"hljs-addition\">+    - cron: &apos;0 3 * * 1&apos; # ogni luned&#xec; alle 03:00 UTC</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+jobs:</span>\n<span class=\"hljs-addition\">+  security-scan:</span>\n<span class=\"hljs-addition\">+    runs-on: ubuntu-latest</span>\n<span class=\"hljs-addition\">+    permissions:</span>\n<span class=\"hljs-addition\">+      security-events: write</span>\n<span class=\"hljs-addition\">+      contents: read</span>\n<span class=\"hljs-addition\">+      actions: read</span>\n<span class=\"hljs-addition\">+      packages: read</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    steps:</span>\n<span class=\"hljs-addition\">+    - name: Checkout code</span>\n<span class=\"hljs-addition\">+      uses: actions/checkout@v4</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Setup Node.js</span>\n<span class=\"hljs-addition\">+      uses: actions/setup-node@v3</span>\n<span class=\"hljs-addition\">+      with:</span>\n<span class=\"hljs-addition\">+        node-version: &apos;18&apos;</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Install JS dependencies</span>\n<span class=\"hljs-addition\">+      run: npm install || echo &quot;No package.json found&quot;</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Run npm audit (JS)</span>\n<span class=\"hljs-addition\">+      run: |</span>\n<span class=\"hljs-addition\">+        mkdir -p security-reports</span>\n<span class=\"hljs-addition\">+        npm audit --json &gt; security-reports/npm-audit.json || true</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Setup Python</span>\n<span class=\"hljs-addition\">+      uses: actions/setup-python@v4</span>\n<span class=\"hljs-addition\">+      with:</span>\n<span class=\"hljs-addition\">+        python-version: &apos;3.x&apos;</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Install Bandit, PHPStan, ShellCheck</span>\n<span class=\"hljs-addition\">+      run: |</span>\n<span class=\"hljs-addition\">+        pip install bandit semgrep</span>\n<span class=\"hljs-addition\">+        sudo apt-get update &amp;&amp; sudo apt-get install -y shellcheck php-cli php-xml php-mbstring</span>\n<span class=\"hljs-addition\">+        composer global require phpstan/phpstan || echo &quot;PHPStan install skipped&quot;</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Run Bandit scan (Python)</span>\n<span class=\"hljs-addition\">+      run: bandit -r . -f json -o security-reports/bandit-report.json || true</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Run ShellCheck (Bash)</span>\n<span class=\"hljs-addition\">+      run: |</span>\n<span class=\"hljs-addition\">+        mkdir -p security-reports/shellcheck</span>\n<span class=\"hljs-addition\">+        find . -name &apos;*.sh&apos; -exec shellcheck -f json -o security-reports/shellcheck/{}.json {} \\; || true</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Run PHPStan (PHP)</span>\n<span class=\"hljs-addition\">+      run: |</span>\n<span class=\"hljs-addition\">+        ~/.composer/vendor/bin/phpstan analyse --error-format=json &gt; security-reports/phpstan-report.json || true</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Run ripgrep for secrets</span>\n<span class=\"hljs-addition\">+      run: |</span>\n<span class=\"hljs-addition\">+        rg --json --json-path &apos;.data.lines[0].text&apos; --json-seq --json-seq-delim &apos;\\n&apos; &apos;token|password|secret|apikey|api_key|access_key|auth&apos; &gt; security-reports/ripgrep-report.json || true</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Run Semgrep with custom rules</span>\n<span class=\"hljs-addition\">+      run: semgrep --config semgrep-rules --json --output security-reports/semgrep-report.json || true</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Initialize CodeQL</span>\n<span class=\"hljs-addition\">+      uses: github/codeql-action/init@v3</span>\n<span class=\"hljs-addition\">+      with:</span>\n<span class=\"hljs-addition\">+        languages: javascript, python, php, bash</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Perform CodeQL Analysis</span>\n<span class=\"hljs-addition\">+      uses: github/codeql-action/analyze@v3</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+    - name: Upload Security Reports</span>\n<span class=\"hljs-addition\">+      uses: actions/upload-artifact@v3</span>\n<span class=\"hljs-addition\">+      with:</span>\n<span class=\"hljs-addition\">+        name: security-reports</span>\n<span class=\"hljs-addition\">+        path: security-reports/</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-comment\">diff --git a/semgrep-rules/hardcoded-secrets.yaml b/semgrep-rules/hardcoded-secrets.yaml</span>\nnew file mode 100644\n<span class=\"hljs-comment\">index 0000000..1234567</span>\n<span class=\"hljs-comment\">--- /dev/null</span>\n<span class=\"hljs-comment\">+++ b/semgrep-rules/hardcoded-secrets.yaml</span>\n<span class=\"hljs-meta\">@@ -0,0 +1,30 @@</span>\n<span class=\"hljs-addition\">+rules:</span>\n<span class=\"hljs-addition\">+  - id: hardcoded-secret</span>\n<span class=\"hljs-addition\">+    patterns:</span>\n<span class=\"hljs-addition\">+      - pattern-either:</span>\n<span class=\"hljs-addition\">+          - pattern: api_key = &quot;&#x24;SECRET&quot;</span>\n<span class=\"hljs-addition\">+          - pattern: password = &quot;&#x24;SECRET&quot;</span>\n<span class=\"hljs-addition\">+          - pattern: token = &quot;&#x24;SECRET&quot;</span>\n<span class=\"hljs-addition\">+          - pattern: const API_KEY = &quot;&#x24;SECRET&quot;</span>\n<span class=\"hljs-addition\">+          - pattern: export SECRET=*</span>\n<span class=\"hljs-addition\">+    message: &quot;Hardcoded secret found. Consider environment variables or secret managers.&quot;</span>\n<span class=\"hljs-addition\">+    severity: ERROR</span>\n<span class=\"hljs-addition\">+    languages: [python, javascript, php, bash]</span>\n<span class=\"hljs-addition\">+    metadata:</span>\n<span class=\"hljs-addition\">+      category: security</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-comment\">diff --git a/semgrep-rules/dangerous-functions.yaml b/semgrep-rules/dangerous-functions.yaml</span>\nnew file mode 100644\n<span class=\"hljs-comment\">index 0000000..2345678</span>\n<span class=\"hljs-comment\">--- /dev/null</span>\n<span class=\"hljs-comment\">+++ b/semgrep-rules/dangerous-functions.yaml</span>\n<span class=\"hljs-meta\">@@ -0,0 +1,35 @@</span>\n<span class=\"hljs-addition\">+rules:</span>\n<span class=\"hljs-addition\">+  - id: dangerous-eval</span>\n<span class=\"hljs-addition\">+    pattern: eval(...)</span>\n<span class=\"hljs-addition\">+    message: &quot;Avoid using eval due to code injection risk.&quot;</span>\n<span class=\"hljs-addition\">+    severity: ERROR</span>\n<span class=\"hljs-addition\">+    languages: [javascript, php, python]</span>\n<span class=\"hljs-addition\">+    metadata:</span>\n<span class=\"hljs-addition\">+      category: security</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+  - id: dangerous-exec</span>\n<span class=\"hljs-addition\">+    pattern: exec(...)</span>\n<span class=\"hljs-addition\">+    message: &quot;Use of exec can lead to command injection. Validate inputs.&quot;</span>\n<span class=\"hljs-addition\">+    severity: ERROR</span>\n<span class=\"hljs-addition\">+    languages: [python]</span>\n<span class=\"hljs-addition\">+    metadata:</span>\n<span class=\"hljs-addition\">+      category: security</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+  - id: dangerous-system</span>\n<span class=\"hljs-addition\">+    pattern: system(...)</span>\n<span class=\"hljs-addition\">+    message: &quot;Use of system calls can be dangerous. Validate inputs.&quot;</span>\n<span class=\"hljs-addition\">+    severity: WARNING</span>\n<span class=\"hljs-addition\">+    languages: [php]</span>\n<span class=\"hljs-addition\">+    metadata:</span>\n<span class=\"hljs-addition\">+      category: security</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-comment\">diff --git a/semgrep-rules/logging-sensitive-data.yaml b/semgrep-rules/logging-sensitive-data.yaml</span>\nnew file mode 100644\n<span class=\"hljs-comment\">index 0000000..3456789</span>\n<span class=\"hljs-comment\">--- /dev/null</span>\n<span class=\"hljs-comment\">+++ b/semgrep-rules/logging-sensitive-data.yaml</span>\n<span class=\"hljs-meta\">@@ -0,0 +1,30 @@</span>\n<span class=\"hljs-addition\">+rules:</span>\n<span class=\"hljs-addition\">+  - id: sensitive-data-logging</span>\n<span class=\"hljs-addition\">+    pattern: |</span>\n<span class=\"hljs-addition\">+      console.log(&#x24;SENSITIVE)</span>\n<span class=\"hljs-addition\">+    message: &quot;Logging sensitive data detected.&quot;</span>\n<span class=\"hljs-addition\">+    severity: WARNING</span>\n<span class=\"hljs-addition\">+    languages: [javascript]</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+  - id: python-logging-sensitive</span>\n<span class=\"hljs-addition\">+    pattern: |</span>\n<span class=\"hljs-addition\">+      logging.info(&#x24;SENSITIVE)</span>\n<span class=\"hljs-addition\">+    message: &quot;Logging potentially sensitive data.&quot;</span>\n<span class=\"hljs-addition\">+    severity: WARNING</span>\n<span class=\"hljs-addition\">+    languages: [python]</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+  - id: php-logging-sensitive</span>\n<span class=\"hljs-addition\">+    pattern: |</span>\n<span class=\"hljs-addition\">+      error_log(&#x24;SENSITIVE)</span>\n<span class=\"hljs-addition\">+    message: &quot;Logging potentially sensitive data.&quot;</span>\n<span class=\"hljs-addition\">+    severity: WARNING</span>\n<span class=\"hljs-addition\">+    languages: [php]</span>\n<span class=\"hljs-comment\">diff --git a/tools/extract_reports.py b/tools/extract_reports.py</span>\nnew file mode 100644\n<span class=\"hljs-comment\">index 0000000..4567890</span>\n<span class=\"hljs-comment\">--- /dev/null</span>\n<span class=\"hljs-comment\">+++ b/tools/extract_reports.py</span>\n<span class=\"hljs-meta\">@@ -0,0 +1,90 @@</span>\n<span class=\"hljs-addition\">+#!/usr/bin/env python3</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+import json</span>\n<span class=\"hljs-addition\">+import os</span>\n<span class=\"hljs-addition\">+import glob</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+def extract_semgrep_issues(path):</span>\n<span class=\"hljs-addition\">+    issues = []</span>\n<span class=\"hljs-addition\">+    try:</span>\n<span class=\"hljs-addition\">+        with open(path, &apos;r&apos;) as f:</span>\n<span class=\"hljs-addition\">+            data = json.load(f)</span>\n<span class=\"hljs-addition\">+        for result in data.get(&apos;results&apos;, []):</span>\n<span class=\"hljs-addition\">+            issues.append({</span>\n<span class=\"hljs-addition\">+                &apos;check_id&apos;: result.get(&apos;check_id&apos;),</span>\n<span class=\"hljs-addition\">+                &apos;message&apos;: result.get(&apos;extra&apos;, {}).get(&apos;message&apos;),</span>\n<span class=\"hljs-addition\">+                &apos;file&apos;: result.get(&apos;path&apos;),</span>\n<span class=\"hljs-addition\">+                &apos;start_line&apos;: result.get(&apos;start&apos;, {}).get(&apos;line&apos;),</span>\n<span class=\"hljs-addition\">+                &apos;end_line&apos;: result.get(&apos;end&apos;, {}).get(&apos;line&apos;),</span>\n<span class=\"hljs-addition\">+                &apos;severity&apos;: result.get(&apos;severity&apos;),</span>\n<span class=\"hljs-addition\">+            })</span>\n<span class=\"hljs-addition\">+    except Exception as e:</span>\n<span class=\"hljs-addition\">+        print(f&quot;Errore nel parsing del report Semgrep: {e}&quot;)</span>\n<span class=\"hljs-addition\">+    return issues</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+def extract_bandit_issues(path):</span>\n<span class=\"hljs-addition\">+    issues = []</span>\n<span class=\"hljs-addition\">+    try:</span>\n<span class=\"hljs-addition\">+        with open(path, &apos;r&apos;) as f:</span>\n<span class=\"hljs-addition\">+            data = json.load(f)</span>\n<span class=\"hljs-addition\">+        for issue in data.get(&apos;results&apos;, []):</span>\n<span class=\"hljs-addition\">+            issues.append({</span>\n<span class=\"hljs-addition\">+                &apos;filename&apos;: issue.get(&apos;filename&apos;),</span>\n<span class=\"hljs-addition\">+                &apos;issue_text&apos;: issue.get(&apos;issue_text&apos;),</span>\n<span class=\"hljs-addition\">+                &apos;severity&apos;: issue.get(&apos;issue_severity&apos;),</span>\n<span class=\"hljs-addition\">+                &apos;line_number&apos;: issue.get(&apos;line_number&apos;),</span>\n<span class=\"hljs-addition\">+            })</span>\n<span class=\"hljs-addition\">+    except Exception as e:</span>\n<span class=\"hljs-addition\">+        print(f&quot;Errore nel parsing del report Bandit: {e}&quot;)</span>\n<span class=\"hljs-addition\">+    return issues</span>\n<span class=\"hljs-addition\">+</span>\n<span class=\"hljs-addition\">+def extract_phpstan</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2771,2992"}},{"content":"<pre data-lines=\"3116,3132\"><code data-lines=\"3116,3132\">\n<span class=\"hljs-meta\">---\n</span>\n<span class=\"hljs-comment\">### Ora puoi:</span>\n\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">clonare</span> <span class=\"hljs-string\">il</span> <span class=\"hljs-string\">repo</span> <span class=\"hljs-string\">o</span> <span class=\"hljs-string\">applicare</span> <span class=\"hljs-string\">la</span> <span class=\"hljs-string\">patch</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">personalizzare</span> <span class=\"hljs-string\">i</span> <span class=\"hljs-string\">branch/tag</span> <span class=\"hljs-string\">da</span> <span class=\"hljs-string\">scansionare</span> <span class=\"hljs-string\">nel</span> <span class=\"hljs-string\">workflow</span> <span class=\"hljs-string\">`.github/workflows/security-scan.yml`</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">aggiungere</span> <span class=\"hljs-string\">o</span> <span class=\"hljs-string\">modificare</span> <span class=\"hljs-string\">regole</span> <span class=\"hljs-string\">Semgrep</span> <span class=\"hljs-string\">in</span> <span class=\"hljs-string\">`semgrep-rules/`</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">eseguire</span> <span class=\"hljs-string\">`python3</span> <span class=\"hljs-string\">tools/extract_reports.py`</span> <span class=\"hljs-string\">per</span> <span class=\"hljs-string\">aggregare</span> <span class=\"hljs-string\">e</span> <span class=\"hljs-string\">visualizzare</span> <span class=\"hljs-string\">i</span> <span class=\"hljs-string\">risultati</span>\n\n<span class=\"hljs-meta\">---\n</span>\n<span class=\"hljs-string\">Se</span> <span class=\"hljs-string\">vuoi,</span> <span class=\"hljs-string\">posso</span> <span class=\"hljs-string\">anche</span> <span class=\"hljs-string\">fornirti</span> <span class=\"hljs-string\">uno</span> <span class=\"hljs-string\">script</span> <span class=\"hljs-string\">per</span> <span class=\"hljs-string\">eseguire</span> <span class=\"hljs-string\">tutte</span> <span class=\"hljs-string\">le</span> <span class=\"hljs-string\">scansioni</span> <span class=\"hljs-string\">localmente</span> <span class=\"hljs-string\">o</span> <span class=\"hljs-string\">ulteriori</span> <span class=\"hljs-string\">regole</span> <span class=\"hljs-string\">Semgrep</span> <span class=\"hljs-string\">mirate!</span>  \n<span class=\"hljs-string\">Fammi</span> <span class=\"hljs-string\">sapere!</span> <span class=\"hljs-string\">&#x1f680;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"3116,3132"}}],"payload":{"tag":"h1","lines":"2752,2753"}}]},null)</script>
</body>
</html>
