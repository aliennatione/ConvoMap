<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.8.0/styles/default.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.2/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.17.2/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.2/dist/index.js"></script><script>((r) => {
            setTimeout(r);
          })(() => {
  const { markmap, mm } = window;
  const toolbar = new markmap.Toolbar();
  toolbar.attach(mm);
  const el = toolbar.render();
  el.setAttribute("style", "position:absolute;bottom:20px;right:20px");
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"<pre><code class=\"language-markmap\"># Multi-Platform Static/Dynamic Site (Free Stack Edition)\n\n## Project Overview &amp; Goals\n### Project Objectives\n- Create static + dynamic site using *only free services*\n- Utilize Supabase for authentication, relational DB, and realtime features\n- Utilize FaunaDB for serverless GraphQL/FQL APIs\n- Serve heavy media (video, audio, images, zip) from Archive.org\n- Host static site with custom domain and HTTPS via GitHub Pages + Cloudflare Pages\n### Context &amp; Purpose\n- Address limits in publishing heavy multimedia without high costs or technical constraints\n- Combine free, powerful, complementary tools for an optimized, scalable ecosystem\n- Adaptable for portfolios, apps with auth/dynamic data, global serverless APIs, media proxies\n\n## Technology Stack\n### Frontend\n- HTML/CSS/JS (Static Responsive Site)\n### Hosting\n- GitHub Pages\n- Cloudflare Pages\n    - Custom domain\n    - CDN\n    - HTTPS\n### Backend\n- Supabase\n    - Relational PostgreSQL DB\n    - Authentication\n    - Realtime\n- FaunaDB\n    - Global serverless DB\n    - GraphQL / FQL API\n### Media Hosting\n- Archive.org\n    - Heavy multimedia files (video, audio, images, zip)\n### Proxy\n- Cloudflare Workers / Pages Functions\n    - Media rewrite\n    - CORS management\n\n## Project Structure\n### Root Files\n- README.md: Project documentation\n- LICENSE: MIT Open Source License\n- .gitignore: Git ignore patterns\n- .env.example: Environment variables example\n- package.json: Node.js dependencies &amp; scripts\n- requirements.txt: Python dependencies\n### Directories\n- public/\n    - index.html: Main HTML file\n    - assets/: Static assets (e.g., style.css)\n- functions/: Cloudflare Pages Functions\n    - media-proxy.js: Cloudflare Worker for media proxy\n- scripts/: Utility scripts\n    - upload_to_archive.sh: Script to upload files to Archive.org\n- examples/: Usage examples\n    - embed-media.html: Example of embedding Archive.org media\n- tests/: Unit tests\n    - test-api-supabase.js: Supabase API connection test\n- workflows/: GitHub Actions workflows\n    - deploy.yml: CI/CD for build, deploy, and archive snapshot\n- config/: Configuration files\n    - supabase-config.js: Supabase client setup\n    - fauna-query-example.gql: Example GraphQL query for FaunaDB\n\n## Installation &amp; Setup\n### Prerequisites\n- Node.js\n- Python (for `internetarchive` CLI)\n- GitHub account &amp; repository\n- Cloudflare account (optional, can use Cloudflare subdomain)\n- Supabase project\n- FaunaDB project\n- Archive.org account\n### Initial Setup Steps\n- **1. Clone Project:**\n    - `git clone https://github.com/tuo-utente/multi-platform-static-dynamic-site.git`\n    - `cd multi-platform-static-dynamic-site`\n- **2. Install Dependencies:**\n    - `npm install`\n    - `pip install -r requirements.txt`\n- **3. Configure Environment Variables:**\n    - `cp .env.example .env`\n    - Edit `.env` with actual keys:\n        - `SUPABASE_URL`\n        - `SUPABASE_KEY`\n        - `FAUNA_SECRET`\n        - `IA_ACCESS_KEY`\n        - `IA_SECRET_KEY`\n\n## Deployment\n### Cloudflare Pages Configuration\n- Connect GitHub repository to Cloudflare Pages\n- Set build output directory: `public`\n- Configure Pages Functions source: `functions/`\n### GitHub Actions Workflow\n- `workflows/deploy.yml` manages:\n    - Build process\n    - Deployment to Cloudflare Pages\n    - Upload snapshot to Archive.org (implied)\n### Outcome\n- Project deployed via GitHub → Cloudflare Pages → Automatic HTTPS with custom domain\n\n## Usage &amp; Configuration\n### Supabase API Client\n- File: `config/supabase-config.js`\n- Content:\n    ```js\n    import { createClient } from '@supabase/supabase-js'\n    const supabaseUrl = import.meta.env.SUPABASE_URL\n    const supabaseKey = import.meta.env.SUPABASE_KEY\n    export const supabase = createClient(supabaseUrl, supabaseKey)\n    ```\n### FaunaDB API Usage Example\n- File: `config/fauna-query-example.gql`\n- Content (GraphQL Query):\n    ```graphql\n    query GetPosts {\n      posts {\n        data {\n          title\n          content\n        }\n      }\n    }\n    ```\n### Cloudflare Media Proxy (Pages Function)\n- File: `functions/media-proxy.js`\n- Functionality:\n    - Rewrites `/media/` paths to `https://archive.org/download/miosito-media/`\n    - Sets `Access-Control-Allow-Origin: *` for CORS\n- Content:\n    ```js\n    export async function onRequest(context) {\n      const url = new URL(context.request.url)\n      const mediaPath = url.pathname.replace('/media/', '/download/miosito-media/')\n      const archiveUrl = `https://archive.org${mediaPath}`\n      const response = await fetch(archiveUrl)\n      const headers = new Headers(response.headers)\n      headers.set('Access-Control-Allow-Origin', '*')\n      return new Response(response.body, { status: response.status, headers })\n    }\n    ```\n### Archive.org Media Upload Script\n- File: `scripts/upload_to_archive.sh`\n- Usage: `bash scripts/upload_to_archive.sh video.mp4`\n- Commands &amp; Actions:\n    - Uses `ia upload` CLI tool\n    - Generates unique ID `miosito-$(date +%F-%H%M%S)` for item\n    - Sets metadata: `title`, `description`, `collection:opensource`\n- Content:\n    ```bash\n    #!/bin/bash\n    FILE=$1\n    ID=\"miosito-$(date +%F-%H%M%S)\"\n    ia upload \"$ID\" \"$FILE\" \\\n      --metadata=\"title:Sito Demo Upload\" \\\n      --metadata=\"description:File caricato automaticamente\" \\\n      --metadata=\"collection:opensource\" \\\n      --retries=3\n    ```\n\n## Testing\n### Supabase API Connection Test\n- File: `tests/test-api-supabase.js`\n- Command: `node tests/test-api-supabase.js`\n- Functionality: Queries `profiles` table to verify connection\n- Content:\n    ```js\n    import { supabase } from '../config/supabase-config.js'\n    async function testConnection() {\n      const { data, error } = await supabase.from('profiles').select('*')\n      if (error) {\n        console.error('Errore Supabase:', error.message)\n      } else {\n        console.log('Dati ricevuti:', data)\n      }\n    }\n    testConnection()\n    ```\n\n## License\n### Type\n- MIT License\n### Details\n- Full text in `LICENSE` file\n- Copyright (c) 2025 [TUO_NOME]\n\n## Key Files &amp; Content Details\n### `README.md`\n- Core project documentation: objectives, stack, installation, deployment, tests, docs, license.\n### `.gitignore`\n- Excludes: `node_modules/`, `.env`, `dist/`, `.cache/`, `.vscode/`, `__pycache__/`, `*.pyc`, `*.zip`, `upload.log`, OS files (`.DS_Store`, `Thumbs.db`).\n### `.env.example`\n- Template for environment variables: `SUPABASE_URL`, `SUPABASE_KEY`, `FAUNA_SECRET`, `IA_ACCESS_KEY`, `IA_SECRET_KEY`.\n### `public/index.html`\n- Main entry point of the static site.\n- Includes `assets/style.css`.\n- References `../config/supabase-config.js` (module type).\n- Example `&lt;video&gt;` embed with source `https://archive.org/download/miosito-media/video.mp4`.\n### `examples/embed-media.html`\n- Simple HTML example for embedding media.\n- Shows basic `&lt;video&gt;` tag with `src` pointing to Archive.org URL.\n### `requirements.txt`\n- Python package dependencies: `internetarchive`, `python-dotenv`.\n### `package.json`\n- Project metadata: `name`, `version`, `description`.\n- Scripts: `dev` (`vite`), `build` (`vite build`), `test` (`node tests/test-api-supabase.js`).\n- Dependencies: `@supabase/supabase-js`.\n</code></pre>","children":[]},null)</script>
</body>
</html>
