<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.8.0/styles/default.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.2/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.17.2/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.2/dist/index.js"></script><script>((r) => {
            setTimeout(r);
          })(() => {
  const { markmap, mm } = window;
  const toolbar = new markmap.Toolbar();
  toolbar.attach(mm);
  const el = toolbar.render();
  el.setAttribute("style", "position:absolute;bottom:20px;right:20px");
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"<pre><code class=\"language-markdown\"><span class=\"hljs-section\"># tgfeed-security-enhancer: Advanced Multi-language Security Scan Integration</span>\n\n<span class=\"hljs-section\">## üéØ Project Goal &amp; Context</span>\n<span class=\"hljs-bullet\">-</span> Provide an integrated system for automated security scanning of multi-language repositories (JS, Python, PHP, Bash).\n<span class=\"hljs-bullet\">-</span> Identify vulnerabilities, bad practices, and sensitive data disclosures.\n<span class=\"hljs-bullet\">-</span> Leverage GitHub Actions for CI/CD automation.\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Initial motivation:**</span> Secure projects like <span class=\"hljs-code\">`tgfeed`</span> efficiently.\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Decision:**</span> Expand from basic Node.js scan to multi-language with diverse tools.\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Outcome:**</span> Comprehensive security coverage for common development stacks.\n\n<span class=\"hljs-section\">## üìÅ Project Structure</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-code\">`.github/workflows/`</span>\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`security-scan.yml`</span>: Main GitHub Actions workflow definition.\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-code\">`patches/`</span>\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`add-security-scan.patch`</span>: Git patch for easy integration into existing repositories.\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-code\">`semgrep-rules/`</span>: Directory for custom Semgrep rules.\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`README.md`</span>: Documentation for custom Semgrep rules.\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`hardcoded-secrets.yaml`</span>: Rule definition for detecting hardcoded secrets.\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`dangerous-functions.yaml`</span>: Rule definition for detecting dangerous function usage.\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`logging-sensitive-data.yaml`</span>: Rule definition for detecting logging of sensitive data.\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-code\">`security-reports/`</span>: (Generated by workflow, intended to store all scan outputs locally).\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-code\">`tools/`</span>\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`extract_reports.py`</span>: Python script to aggregate and display scan reports.\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`README.md`</span>: (Placeholder for tools documentation).\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-code\">`.gitignore`</span>: Specifies files/directories to be ignored by Git.\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-code\">`LICENSE`</span>: Project licensing details (MIT License).\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-code\">`README.md`</span>: Project overview, objectives, and usage instructions.\n\n<span class=\"hljs-section\">## üöÄ GitHub Actions Workflow (`.github/workflows/security-scan.yml`)</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Name**</span>: Security Scan Multi-language Advanced\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Triggers**</span>:\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`push`</span> on branches: <span class=\"hljs-code\">`main`</span>, <span class=\"hljs-code\">`develop`</span>\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`pull_request`</span> on branches: <span class=\"hljs-code\">`main`</span>, <span class=\"hljs-code\">`develop`</span>\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`workflow_dispatch`</span>: Manual trigger via GitHub UI.\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`schedule`</span>: <span class=\"hljs-code\">`cron: '0 3 * * 1'`</span> (Every Monday at 03:00 UTC).\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Permissions**</span>:\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`security-events: write`</span>\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`contents: read`</span>\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`actions: read`</span>\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`packages: read`</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Jobs**</span>: <span class=\"hljs-code\">`security-scan`</span> (runs on <span class=\"hljs-code\">`ubuntu-latest`</span>)\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-strong\">**Steps**</span>:\n<span class=\"hljs-bullet\">    -</span> <span class=\"hljs-code\">`Checkout code`</span>: <span class=\"hljs-code\">`uses: actions/checkout@v4`</span>\n<span class=\"hljs-bullet\">    -</span> <span class=\"hljs-code\">`Setup Node.js`</span>: <span class=\"hljs-code\">`uses: actions/setup-node@v3`</span> with <span class=\"hljs-code\">`node-version: '18'`</span>\n<span class=\"hljs-bullet\">    -</span> <span class=\"hljs-code\">`Install JS dependencies`</span>: <span class=\"hljs-code\">`run: npm install || echo \"No package.json found\"`</span>\n<span class=\"hljs-bullet\">    -</span> <span class=\"hljs-code\">`Run npm audit (JS)`</span>: <span class=\"hljs-code\">`run: npm audit --json &gt; security-reports/npm-audit.json || true`</span>\n<span class=\"hljs-bullet\">    -</span> <span class=\"hljs-code\">`Setup Python`</span>: <span class=\"hljs-code\">`uses: actions/setup-python@v4`</span> with <span class=\"hljs-code\">`python-version: '3.x'`</span>\n<span class=\"hljs-bullet\">    -</span> <span class=\"hljs-code\">`Install Static Analysis Tools`</span>:\n<span class=\"hljs-bullet\">      -</span> <span class=\"hljs-code\">`run: pip install bandit semgrep`</span>\n<span class=\"hljs-bullet\">      -</span> <span class=\"hljs-code\">`run: sudo apt-get update &amp;&amp; sudo apt-get install -y shellcheck php-cli php-xml php-mbstring`</span>\n<span class=\"hljs-bullet\">      -</span> <span class=\"hljs-code\">`run: composer global require phpstan/phpstan || echo \"PHPStan install skipped\"`</span>\n<span class=\"hljs-bullet\">    -</span> <span class=\"hljs-code\">`Run Bandit scan (Python)`</span>: <span class=\"hljs-code\">`run: bandit -r . -f json -o security-reports/bandit-report.json || true`</span>\n<span class=\"hljs-bullet\">    -</span> <span class=\"hljs-code\">`Run ShellCheck (Bash)`</span>: <span class=\"hljs-code\">`run: find . -name '*.sh' -exec shellcheck -f json -o security-reports/shellcheck/{}.json {} \\; || true`</span>\n<span class=\"hljs-bullet\">    -</span> <span class=\"hljs-code\">`Run PHPStan (PHP)`</span>: <span class=\"hljs-code\">`run: ~/.composer/vendor/bin/phpstan analyse --error-format=json &gt; security-reports/phpstan-report.json || true`</span>\n<span class=\"hljs-bullet\">    -</span> <span class=\"hljs-code\">`Run ripgrep for secrets`</span>: <span class=\"hljs-code\">`run: rg --json --json-path '.data.lines[0].text' --json-seq --json-seq-delim '\\n' 'token|password|secret|apikey|api_key|access_key|auth' &gt; security-reports/ripgrep-report.json || true`</span>\n<span class=\"hljs-bullet\">    -</span> <span class=\"hljs-code\">`Run Semgrep with custom rules`</span>: <span class=\"hljs-code\">`run: semgrep --config semgrep-rules --json --output security-reports/semgrep-report.json || true`</span>\n<span class=\"hljs-bullet\">    -</span> <span class=\"hljs-code\">`Initialize CodeQL`</span>: <span class=\"hljs-code\">`uses: github/codeql-action/init@v3`</span> (languages: <span class=\"hljs-code\">`javascript, python, php, bash`</span>)\n<span class=\"hljs-bullet\">    -</span> <span class=\"hljs-code\">`Perform CodeQL Analysis`</span>: <span class=\"hljs-code\">`uses: github/codeql-action/analyze@v3`</span>\n<span class=\"hljs-bullet\">    -</span> <span class=\"hljs-code\">`Upload Security Reports`</span>: <span class=\"hljs-code\">`uses: actions/upload-artifact@v3`</span> (name: <span class=\"hljs-code\">`security-reports`</span>, path: <span class=\"hljs-code\">`security-reports/`</span>)\n\n<span class=\"hljs-section\">## üõ†Ô∏è Tools &amp; Reporting (`tools/extract<span class=\"hljs-emphasis\">_reports.py`)\n- <span class=\"hljs-strong\">**Purpose**</span>: Python script for aggregating and displaying security scan results from various tools.\n- <span class=\"hljs-strong\">**Key Functions**</span>:\n  - `extract_</span>semgrep<span class=\"hljs-emphasis\">_issues(path)`: Parses Semgrep JSON reports.\n  - `extract_</span>bandit<span class=\"hljs-emphasis\">_issues(path)`: Parses Bandit JSON reports.\n  - `extract_</span>phpstan<span class=\"hljs-emphasis\">_issues(path)`: Parses PHPStan JSON reports.\n  - `extract_</span>shellcheck<span class=\"hljs-emphasis\">_issues(dir_</span>path)`: Parses multiple ShellCheck JSON reports.</span>\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`extract_ripgrep_issues(path)`</span>: Parses ripgrep JSON sequence reports.\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Output**</span>: Formatted summary of findings, highlighting issues by tool and severity.\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Local Usage Command**</span>: <span class=\"hljs-code\">`python3 tools/extract_reports.py`</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Decision:**</span> Create a centralized reporting script for clarity.\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Outcome:**</span> Easier digestion of diverse scan results.\n\n<span class=\"hljs-section\">## üì¶ Custom Semgrep Rules Details (`semgrep-rules/`)</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**README.md**</span> (content specified in log)\n<span class=\"hljs-bullet\">  -</span> Documents how to use and add custom Semgrep rules.\n<span class=\"hljs-bullet\">  -</span> Local Testing Command: <span class=\"hljs-code\">`semgrep --config semgrep-rules/ .`</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**`hardcoded-secrets.yaml`**</span>:\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`id: hardcoded-secret`</span>\n<span class=\"hljs-bullet\">  -</span> Patterns: <span class=\"hljs-code\">`api_key = \"$SECRET\"`</span>, <span class=\"hljs-code\">`password = \"$SECRET\"`</span>, <span class=\"hljs-code\">`token = \"$SECRET\"`</span>, <span class=\"hljs-code\">`const API_KEY = \"$SECRET\"`</span>, <span class=\"hljs-code\">`export SECRET=*`</span>\n<span class=\"hljs-bullet\">  -</span> Message: \"Hardcoded secret found. Consider environment variables or secret managers.\"\n<span class=\"hljs-bullet\">  -</span> Severity: <span class=\"hljs-code\">`ERROR`</span>\n<span class=\"hljs-bullet\">  -</span> Languages: <span class=\"hljs-code\">`python, javascript, php, bash`</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**`dangerous-functions.yaml`**</span>:\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`id: dangerous-eval`</span>: Patterns <span class=\"hljs-code\">`eval(...)`</span> (JS, PHP, Python), Message \"Avoid using eval due to code injection risk.\", Severity <span class=\"hljs-code\">`ERROR`</span>\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`id: dangerous-exec`</span>: Patterns <span class=\"hljs-code\">`exec(...)`</span> (Python), Message \"Use of exec can lead to command injection. Validate inputs.\", Severity <span class=\"hljs-code\">`ERROR`</span>\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`id: dangerous-system`</span>: Patterns <span class=\"hljs-code\">`system(...)`</span> (PHP), Message \"Use of system calls can be dangerous. Validate inputs.\", Severity <span class=\"hljs-code\">`WARNING`</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**`logging-sensitive-data.yaml`**</span>:\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`id: sensitive-data-logging`</span>: Patterns <span class=\"hljs-code\">`console.log($SENSITIVE)`</span> (JS), Message \"Logging sensitive data detected.\", Severity <span class=\"hljs-code\">`WARNING`</span>\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`id: python-logging-sensitive`</span>: Patterns <span class=\"hljs-code\">`logging.info($SENSITIVE)`</span> (Python), Message \"Logging potentially sensitive data.\", Severity <span class=\"hljs-code\">`WARNING`</span>\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`id: php-logging-sensitive`</span>: Patterns <span class=\"hljs-code\">`error_log($SENSITIVE)`</span> (PHP), Message \"Logging potentially sensitive data.\", Severity <span class=\"hljs-code\">`WARNING`</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Decision:**</span> Use custom Semgrep rules to target specific project risks (e.g., hardcoded secrets, dangerous functions).\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Outcome:**</span> Enhanced detection capabilities beyond generic checks, tailored to project needs.\n\n<span class=\"hljs-section\">## üìö Installation &amp; Usage Instructions</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Clone Repository**</span>:\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-code\">`git clone https://github.com/tuoutente/tgfeed-security-enhancer.git`</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Apply Patch**</span>: (For existing repositories)\n<span class=\"hljs-bullet\">  -</span> Command: <span class=\"hljs-code\">`git apply patches/add-security-scan.patch`</span>\n<span class=\"hljs-bullet\">  -</span> Patch file <span class=\"hljs-code\">`patches/add-security-scan.patch`</span> contains all new/modified files (<span class=\"hljs-code\">`.github/workflows/security-scan.yml`</span>, <span class=\"hljs-code\">`semgrep-rules/*`</span>, <span class=\"hljs-code\">`tools/extract_reports.py`</span>, <span class=\"hljs-code\">`.gitignore`</span>, etc.).\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Configuration**</span>:\n<span class=\"hljs-bullet\">  -</span> Modify <span class=\"hljs-code\">`.github/workflows/security-scan.yml`</span> to adjust branches/tags or schedule.\n<span class=\"hljs-bullet\">  -</span> Customize or add new rules in the <span class=\"hljs-code\">`semgrep-rules/`</span> directory.\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Execution**</span>:\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-strong\">**Automated**</span>: GitHub Actions triggers on <span class=\"hljs-code\">`push`</span>, <span class=\"hljs-code\">`pull_request`</span>, or weekly <span class=\"hljs-code\">`schedule`</span>.\n<span class=\"hljs-bullet\">  -</span> <span class=\"hljs-strong\">**Manual Local Report Extraction**</span>: <span class=\"hljs-code\">`python3 tools/extract_reports.py`</span> (after reports are generated by the workflow or local tools).\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-strong\">**Output**</span>: Raw reports saved in <span class=\"hljs-code\">`security-reports/`</span> folder, which are also uploaded as GitHub Actions artifacts.\n\n<span class=\"hljs-section\">## üåê Technologies Utilized</span>\n<span class=\"hljs-bullet\">-</span> GitHub Actions\n<span class=\"hljs-bullet\">-</span> CodeQL\n<span class=\"hljs-bullet\">-</span> Semgrep\n<span class=\"hljs-bullet\">-</span> Bandit (Python static analyzer)\n<span class=\"hljs-bullet\">-</span> PHPStan (PHP static analyzer)\n<span class=\"hljs-bullet\">-</span> ShellCheck (Bash linter/analyzer)\n<span class=\"hljs-bullet\">-</span> Ripgrep (Fast text search for secrets)\n\n<span class=\"hljs-section\">## üí° Customization &amp; Extension Points</span>\n<span class=\"hljs-bullet\">-</span> Amplify <span class=\"hljs-code\">`semgrep-rules/`</span> with more targeted, project-specific rules.\n<span class=\"hljs-bullet\">-</span> Parametrize workflow for scanning specific branches, tags, or paths.\n<span class=\"hljs-bullet\">-</span> Add notifications (e.g., Slack, email) for critical vulnerabilities detected.\n<span class=\"hljs-bullet\">-</span> Integrate other scanners (e.g., Trivy for container/secrets scanning, if relevant).\n</code></pre>","children":[]},null)</script>
</body>
</html>
